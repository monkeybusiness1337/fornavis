!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.fornac=t():e.fornac=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e,t){function n(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function o(e){var t=e,r=e.prevNode,o=6;if(null!==r&&e.linked){var i=[-(t.x-r.x),-(t.y-r.y)];i=[i[0]/n(i),i[1]/n(i)];var s=[-i[1],i[0]],a=[e.radius*i[0],e.radius*i[1]],u="M"+(a[0]+o*(i[0]+s[0])/2)+","+(a[1]+o*(i[1]+s[1])/2)+"L"+a[0]+","+a[1]+"L"+(a[0]+o*(i[0]-s[0])/2)+","+(a[1]+o*(i[1]-s[1])/2);d3.select(this).attr("d",u)}}function l(e){return"basepair"==e.linkType||"backbone"==e.linkType||"pseudoknot"==e.linkType||"label_link"==e.linkType||"external"==e.linkType||"chain_chain"==e.linkType}function c(e,t,n){if(e.hasOwnProperty(t.num)){var r=parseFloat(e[t.num]);return isNaN(r)?e[t.num]:n(r)}return"white"}function p(){}function f(){N&&(mpos=d3.mouse(L.node()),F.attr("x1",N.x).attr("y1",N.y).attr("x2",mpos[0]).attr("y2",mpos[1]))}function h(){N&&F.attr("class","drag_line_hidden"),y()}function d(){var e=X.selectAll("g.gnode").selectAll(".outline_node");e.each(function(e){e.selected=!1,e.previouslySelected=!1}),e.classed("selected",!1)}function g(){L.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")}function y(){N=null,M=null,E=null}function v(e){var t=X.selectAll("g.gnode");return B?t.filter(function(e){return e.selected}):t.filter(function(e){return e.selected})}function b(e){if(d3.event.sourceEvent.stopPropagation(),!e.selected&&!B){var t=X.selectAll("g.gnode").selectAll(".outline_node");t.classed("selected",function(e){return e.selected=S.options.applyForce&&(e.previouslySelected=!1)})}d3.select(this).select(".outline_node").classed("selected",function(t){return e.previouslySelected=e.selected,e.selected=S.options.applyForce&&!0});var n=v(e);n.each(function(e){e.fixed|=2})}function m(e){var t=v(e);t.each(function(e){e.x+=d3.event.dx,e.y+=d3.event.dy,e.px+=d3.event.dx,e.py+=d3.event.dy}),S.resumeForce(),d3.event.sourceEvent.preventDefault()}function k(e){var t=v(e);t.each(function(e){e.fixed&=-7})}function x(e){var t=e.radius+16,n=e.x-t,r=e.x+t,o=e.y-t,i=e.y+t;return function(t,s,a,u,l){if(t.point&&t.point!==e){var c=e.x-t.point.x,p=e.y-t.point.y,f=Math.sqrt(c*c+p*p),h=e.radius+t.point.radius;h>f&&(f=(f-h)/f*.1,e.x-=c*=f,e.y-=p*=f,t.point.x+=c,t.point.y+=p)}return s>r||n>u||a>i||o>l}}function w(){if(!S.deaf&&!Y){switch(d3.event.keyCode){case 16:Y=!0;break;case 17:B=!0;break;case 67:S.centerView()}(Y||B)&&(A.call(S.zoomer).on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null),L.selectAll("g.gnode").on("mousedown.drag",null)),B&&(I.select(".background").style("cursor","crosshair"),I.call(S.brusher))}}function O(){Y=!1,B=!1,I.call(S.brusher).on("mousedown.brush",null).on("touchstart.brush",null).on("touchmove.brush",null).on("touchend.brush",null),I.select(".background").style("cursor","auto"),A.call(S.zoomer),L.selectAll("g.gnode").call(z)}var S=this;if(S.options={displayAllLinks:!1,labelInterval:10,applyForce:!0,chargeDistance:180,friction:.9,middleCharge:-30,otherCharge:-30,linkDistanceMultiplier:15,initialSize:null,allowPanningAndZooming:!0,transitionDuration:500,resizeSvgOnResize:!0,alpha:.1,theta:.8},arguments.length>1)for(var T in t)S.options.hasOwnProperty(T)&&(S.options[T]=t[T]);null!==S.options.initialSize?(S.options.svgW=S.options.initialSize[0],S.options.svgH=S.options.initialSize[1]):(S.options.svgW=800,S.options.svgH=800);var E=(d3.scale.category20(),null),N=null,M=null,j=d3.scale.linear().domain([0,S.options.svgW]).range([0,S.options.svgW]),_=d3.scale.linear().domain([0,S.options.svgH]).range([0,S.options.svgH]),P=S.graph={nodes:[],links:[]};S.linkStrengths={pseudoknot:0,proteinChain:0,chainChain:0,intermolecule:10,external:0,other:10},S.displayParameters={displayBackground:"true",displayNumbering:"true",displayNodeOutline:"true",displayNodeLabel:"true",displayLinks:"true",displayPseudoknotLinks:"true",displayProteinLinks:"true"},S.colorScheme="structure",S.customColors={},S.animation=S.options.applyForce,S.deaf=!1,S.rnas={},S.extraLinks=[],Array.prototype.equals=function(e){if(!e)return!1;if(this.length!=e.length)return!1;for(var t=0,n=this.length;n>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!=e[t])return!1;return!0},S.createInitialLayout=function(e,t){var n={sequence:"",name:"empty",positions:[],labelInterval:S.options.labelInterval,avoidOthers:!0,uids:[],circularizeExternal:!0};if(2==arguments.length)for(var r in t)n.hasOwnProperty(r)&&(n[r]=t[r]);var o=new s.RNAGraph(n.sequence,e,n.name);o.circularizeExternal=n.circularizeExternal;var i=o.recalculateElements();if(0===n.positions.length){var a=new u.NAView,l=a.naview_xy_coordinates(o.pairtable);n.positions=[];for(var c=0;c<l.nbase;c++)n.positions.push([l.x[c],l.y[c]])}return i=i.elementsToJson().addUids(n.uids).addPositions("nucleotide",n.positions).addLabels(1,n.labelInterval).reinforceStems().reinforceLoops().connectFakeNodes().reassignLinkUids().breakNodesToFakeNodes()},S.addRNA=function(e,t){var n=S.createInitialLayout(e,t);if(1===arguments.length&&(t={}),"extraLinks"in t){var r=S.addExternalLinks(n,t.extraLinks);S.extraLinks=S.extraLinks.concat(r)}return"avoidOthers"in t?S.addRNAJSON(n,t.avoidOthers):S.addRNAJSON(n,!0),n},S.addExternalLinks=function(e,t){for(var n=[],r=0;r<t.length;r++){var o={linkType:"external",value:1,uid:generateUUID(),source:null,target:null};if("[object Array]"===Object.prototype.toString.call(t[r][0])){for(var i=0;i<e.nodes.length;i++)if("nucs"in e.nodes[i]&&e.nodes[i].nucs.equals(t[r][0])){o.source=e.nodes[i];break}}else for(var i=0;i<e.nodes.length;i++)e.nodes[i].num==t[r][0]&&(o.source=e.nodes[i]);if("[object Array]"===Object.prototype.toString.call(t[r][1]))for(var i=0;i<e.nodes.length;i++)"nucs"in e.nodes[i]&&e.nodes[i].nucs.equals(t[r][1])&&(o.target=e.nodes[i]);else for(var i=0;i<e.nodes.length;i++)e.nodes[i].num==t[r][1]&&(o.target=e.nodes[i]);null!=o.source&&null!=o.target?n.push(o):console.log("ERROR: source or target of new link not found:",o,t[r])}return n},S.addRNAJSON=function(e,t){var n,r;return t&&(n=S.graph.nodes.length>0?d3.max(S.graph.nodes.map(function(e){return e.x})):0,r=d3.min(e.nodes.map(function(e){return e.x})),e.nodes.forEach(function(e){e.x+=n-r+20,e.px+=n-r})),e.nodes.forEach(function(t){t.rna=e}),S.rnas[e.uid]=e,S.recalculateGraph(),S.update(),S.centerView(),e},S.transitionRNA=function(e,t){function n(e,t){0===e.size()&&setTimeout(t,i);var n=0;e.each(function(){++n}).each("end",function(){--n||t.apply(this,arguments)})}function r(){S.createNewLinks(p.enter());S.graph.links=p.data(),S.updateStyle(),"undefined"!=typeof t&&t()}var i=S.options.transitionDuration,s=S.graph.nodes.filter(function(e){return"nucleotide"==e.nodeType}).map(function(e){return e.uid}),a={uids:s},u=S.createInitialLayout(e,a),c=X.selectAll("g.gnode").data(u.nodes,U),i=S.options.transitionDuration;0===i?c.attr("transform",function(e){return"translate("+[e.x,e.y]+")"}):c.transition().attr("transform",function(e){return"translate("+[e.x,e.y]+")"}).duration(i);var p=R.selectAll("line.link").data(u.links.filter(l),D),f=S.createNewNodes(c.enter()).attr("transform",function(e){return"undefined"!=typeof e.x&&"undefined"!=typeof e.y?"translate("+[0,0]+")":""});if(0===i?c.exit().remove():c.exit().transition().attr("transform",function(e){return"undefined"!=typeof e.x&&"undefined"!=typeof e.y?"translate("+[0,0]+")":""}),c.select("path").each(o),S.graph.nodes=c.data(),S.updateStyle(),S.centerView(i),p.exit().remove(),0===i){p.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y});S.createNewLinks(p.enter());S.graph.links=p.data(),S.updateStyle()}else p.transition().attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}).duration(i).call(n,r);0===i?f.attr("transform",function(e){return"undefined"!=typeof e.x&&"undefined"!=typeof e.y?"translate("+[e.x,e.y]+")":""}):f.transition().attr("transform",function(e){return"undefined"!=typeof e.x&&"undefined"!=typeof e.y?"translate("+[e.x,e.y]+")":""})},S.recalculateGraph=function(){S.graph.nodes=[],S.graph.links=[];for(var e in S.rnas)S.graph.nodes=S.graph.nodes.concat(S.rnas[e].nodes),S.graph.links=S.graph.links.concat(S.rnas[e].links);for(var t={},n=0;n<S.graph.nodes.length;n++)t[S.graph.nodes[n].uid]=S.graph.nodes[n];for(S.graph.links.forEach(function(e){e.source=t[e.source.uid],e.target=t[e.target.uid]}),n=0;n<S.extraLinks.length;n++){if(S.extraLinks[n].target.uid in t||console.log("not there:",S.extraLinks[n]),S.extraLinks[n].source=t[S.extraLinks[n].source.uid],S.extraLinks[n].target=t[S.extraLinks[n].target.uid],"intermolecule"==S.extraLinks[n].linkType){fakeLinks=S.graph.links.filter(function(e){return(e.source==S.extraLinks[n].source||e.source==S.extraLinks[n].target||e.target==S.extraLinks[n].source||e.target==S.extraLinks[n].source)&&"fake"==e.linkType});for(var r=0;r<fakeLinks.length;r++){var o=S.graph.links.indexOf(fakeLinks[r]);S.graph.links.splice(o,1)}}P.links.push(S.extraLinks[n])}},S.addNodes=function(e){e.links.forEach(function(t){"number"==typeof t.source&&(t.source=e.nodes[t.source]),"number"==typeof t.target&&(t.target=e.nodes[t.target])}),S.graph.nodes.length>0?(maxX=d3.max(S.graph.nodes.map(function(e){return e.x})),maxY=d3.max(S.graph.nodes.map(function(e){return e.y}))):(maxX=0,maxY=0),e.nodes.forEach(function(e){e.rna.uid in S.rnas||(S.rnas[e.rna.uid]=e.rna),e.x+=maxX,e.px+=maxX}),r=new s.RNAGraph("",""),r.nodes=e.nodes,r.links=e.links,S.recalculateGraph(),S.update(),S.centerView()},S.addCustomColors=function(e){S.customColors=e},S.addCustomColorsText=function(e){var t=new a.ColorScheme(e);S.customColors=t.colorsJson,S.changeColorScheme("custom")},S.clearNodes=function(){S.graph.nodes=[],S.graph.links=[],S.rnas={},S.extraLinks=[],S.update()},S.toJSON=function(){var e={rnas:S.rnas,extraLinks:S.extraLinks},t=JSON.stringify(e,function(e,t){return"rna"==e?void 0:t},"	");return t},S.fromJSON=function(e){var t,n;try{var o=JSON.parse(e);t=o.rnas,n=o.extraLinks}catch(i){throw i}for(var a in t)"rna"==t[a].type?(r=new s.RNAGraph,r.seq=t[a].seq,r.dotbracket=t[a].dotbracket,r.circular=t[a].circular,r.pairtable=t[a].pairtable,r.uid=t[a].uid,r.structName=t[a].structName,r.nodes=t[a].nodes,r.links=t[a].links,r.rnaLength=t[a].rnaLength,r.elements=t[a].elements,r.nucsToNodes=t[a].nucsToNodes,r.pseudoknotPairs=t[a].pseudoknotPairs):(r=new ProteinGraph,r.size=t[a].size,r.nodes=t[a].nodes,r.uid=t[a].uid),S.addRNAJSON(r,!1);n.forEach(function(e){S.extraLinks.push(e)}),S.recalculateGraph(),S.update()},S.setSize=function(){if(null==S.options.initialSize){var t=d3.select(e).node().offsetHeight,n=d3.select(e).node().offsetWidth;S.options.svgW=n,S.options.svgH=t,j.range([0,n]).domain([0,n]),_.range([0,t]).domain([0,t]),S.zoomer.x(j).y(_),S.brusher.x(j).y(_),S.centerView(),S.options.resizeSvgOnResize&&C.attr("width",n).attr("height",t)}},S.setOutlineColor=function(e){var t=X.selectAll("g.gnode").select("[node_type=nucleotide]");t.style("fill",e)},S.changeColorScheme=function(e){var t=X.selectAll("[node_type=protein]");t.classed("protein",!0).attr("r",function(e){return e.radius});var n=(X.selectAll("g.gnode"),X.selectAll("g.gnode").selectAll("circle"),X.selectAll("g.gnode").select("[node_type=nucleotide]"));if(S.colorScheme=e,"sequence"==e){var r=d3.scale.ordinal().range(["#dbdb8d","#98df8a","#ff9896","#aec7e8","#aec7e8"]).domain(["A","C","G","U","T"]);n.style("fill",function(e){return r(e.name)})}else if("structure"==e){var r=d3.scale.category10().domain(["s","m","i","e","t","h","x"]).range(["lightgreen","#ff9896","#dbdb8d","lightsalmon","lightcyan","lightblue","transparent"]);n.style("fill",function(e){return r(e.elemType)})}else if("positions"==e)n.style("fill",function(e){var t=d3.scale.linear().range(["#98df8a","#dbdb8d","#ff9896"]).interpolate(d3.interpolateLab).domain([1,1+(e.rna.rnaLength-1)/2,e.rna.rnaLength]);return t(e.num)});else if("custom"==e){if("undefined"!=typeof S.customColors&&"domain"in S.customColors&&"range"in S.customColors)var r=d3.scale.linear().interpolate(d3.interpolateLab).domain(S.customColors.domain).range(S.customColors.range);n.style("fill",function(e){if("undefined"==typeof S.customColors||!S.customColors.hasOwnProperty("colorValues"))return"white";if(S.customColors.colorValues.hasOwnProperty(e.structName)&&S.customColors.colorValues[e.structName].hasOwnProperty(e.num)){var t=S.customColors.colorValues[e.structName];return c(t,e,r)}if(S.customColors.colorValues.hasOwnProperty("")){var n=S.customColors.colorValues[""];return c(n,e,r)}return"white"})}},window.addEventListener("resize",S.setSize,!1),S.zoomer=d3.behavior.zoom().scaleExtent([.1,10]).x(j).y(_).on("zoomstart",d).on("zoom",g),d3.select(e).select("svg").remove();var C=d3.select(e).attr("tabindex",1).on("keydown.brush",w).on("keyup.brush",O).each(function(){this.focus()}).append("svg:svg").attr("width",S.options.svgW).attr("height",S.options.svgH).attr("id","plotting-area");S.options.svg=C;var A=C.append("svg:g").on("mousemove",f).on("mousedown",p).on("mouseup",h);S.options.allowPanningAndZooming&&A.call(S.zoomer);var I=A.append("g").datum(function(){return{selected:!1,previouslySelected:!1}}).attr("class","brush"),L=A.append("svg:g"),R=L.append("svg:g"),X=L.append("svg:g");S.brusher=d3.svg.brush().x(j).y(_).on("brushstart",function(e){var t=X.selectAll("g.gnode").selectAll(".outline_node");t.each(function(e){e.previouslySelected=B&&e.selected})}).on("brush",function(){var e=X.selectAll("g.gnode").selectAll(".outline_node"),t=d3.event.target.extent();e.classed("selected",function(e){return e.selected=S.options.applyForce&&e.previouslySelected^(t[0][0]<=e.x&&e.x<t[1][0]&&t[0][1]<=e.y&&e.y<t[1][1])})}).on("brushend",function(){d3.event.target.clear(),d3.select(this).call(d3.event.target)}),I.call(S.brusher).on("mousedown.brush",null).on("touchstart.brush",null).on("touchmove.brush",null).on("touchend.brush",null),I.select(".background").style("cursor","auto"),S.getBoundingBoxTransform=function(){if(0===S.graph.nodes.length)return{translate:[0,0],scale:1};var e=d3.min(S.graph.nodes.map(function(e){return e.x})),t=d3.min(S.graph.nodes.map(function(e){return e.y})),n=d3.max(S.graph.nodes.map(function(e){return e.x})),r=d3.max(S.graph.nodes.map(function(e){return e.y})),o=n-e,i=r-t,s=S.options.svgW/(o+1),a=S.options.svgH/(i+1),u=.8*Math.min(s,a),l=o*u,c=i*u,p=-e*u+(S.options.svgW-l)/2,f=-t*u+(S.options.svgH-c)/2;return{translate:[p,f],scale:u}},S.centerView=function(e){0===arguments.length&&(e=0);var t=S.getBoundingBoxTransform();null!==t&&(L.transition().attr("transform","translate("+t.translate+") scale("+t.scale+")").duration(e),S.zoomer.translate(t.translate),S.zoomer.scale(t.scale))},S.force=d3.layout.force().charge(function(e){return"middle"==e.nodeType?S.options.middleCharge:S.options.otherCharge}).friction(S.options.friction).linkDistance(function(e){return S.options.linkDistanceMultiplier*e.value}).linkStrength(function(e){return e.linkType in S.linkStrengths?S.linkStrengths[e.linkType]:S.linkStrengths.other}).gravity(0).theta(S.options.theta).alpha(S.options.alpha).nodes(S.graph.nodes).links(S.graph.links).chargeDistance(S.options.chargeDistance).size([S.options.svgW,S.options.svgH]);var F=L.append("line").attr("class","drag_line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",0),Y=!1,B=!1;S.resumeForce=function(){S.animation&&S.force.resume()};var z=d3.behavior.drag().on("dragstart",b).on("drag",m).on("dragend",k);d3.select(e).on("keydown",w).on("keyup",O).on("contextmenu",function(){d3.event.preventDefault()});var D=function(e){return e.uid},U=function(e){var t=e.uid;return t},q=function(e){var t=e.getPositions("nucleotide"),n=e.getPositions("label"),r=e.getUids();e.recalculateElements().elementsToJson().addPseudoknots().addPositions("nucleotide",t).addUids(r).addLabels(1,S.options.labelInterval).addPositions("label",n).reinforceStems().reinforceLoops().updateLinkUids()},G=function(e){if(index=S.graph.links.indexOf(e),index>-1){if(e.source.rna==e.target.rna){var t=e.source.rna;t.addPseudoknots(),t.pairtable[e.source.num]=0,t.pairtable[e.target.num]=0,q(t)}else extraLinkIndex=S.extraLinks.indexOf(e),S.extraLinks.splice(extraLinkIndex,1);S.recalculateGraph()}S.update()},V=function(e){if(Y){var t={backbone:!0,fake:!0,fake_fake:!0,label_link:!0};e.linkType in t||G(e)}};S.addLink=function(e){e.source.rna==e.target.rna?(r=e.source.rna,r.pairtable[e.source.num]=e.target.num,r.pairtable[e.target.num]=e.source.num,q(r)):(e.linkType="intermolecule",S.extraLinks.push(e)),S.recalculateGraph(),S.update()};var H=function(e){if(!d3.event.defaultPrevented){if(!B){var t=X.selectAll("g.gnode").selectAll(".outline_node");t.classed("selected",function(e){return e.selected=S.options.applyForce&&(e.previouslySelected=!1)})}d3.select(this).select("circle").classed("selected",e.selected=S.options.applyForce&&!e.previouslySelected)}},W=function(e){if(N){if(M=e,M==N)return void y();var t={source:N,target:M,linkType:"basepair",value:1,uid:generateUUID()};for(i=0;i<S.graph.links.length;i++){if(!(S.graph.links[i].source!=N&&S.graph.links[i].target!=N&&S.graph.links[i].source!=M&&S.graph.links[i].target!=M||"basepair"!=S.graph.links[i].linkType&&"pseudoknot"!=S.graph.links[i].linkType))return;if((S.graph.links[i].source==M&&S.graph.links[i].target==N||S.graph.links[i].source==N&&S.graph.links[i].target==M)&&"backbone"==S.graph.links[i].linkType)return}if("middle"==M.nodeType||"middle"==N.nodeType||"label"==M.nodeType||"label"==N.nodeType)return;S.addLink(t)}},J=function(e){if(!e.selected&&!B){var t=X.selectAll("g.gnode").selectAll(".outline_node");t.classed("selected",function(e){return e.selected=e.previouslySelected=!1})}d3.select(this).classed("selected",function(t){return e.previouslySelected=e.selected,e.selected=S.options.applyForce&&!0}),Y&&(N=e,F.attr("class","drag_line").attr("x1",N.x).attr("y1",N.y).attr("x2",N.x).attr("y2",N.y))};S.startAnimation=function(){S.animation=!0,L.selectAll("g.gnode").call(z),S.force.start()},S.stopAnimation=function(){S.animation=!1,L.selectAll("g.gnode").on("mousedown.drag",null),S.force.stop()},S.setFriction=function(e){S.force.friction(e),S.resumeForce()},S.setCharge=function(e){S.force.charge(e),S.resumeForce()},S.setGravity=function(e){S.force.gravity(e),S.resumeForce()},S.setPseudoknotStrength=function(e){S.linkStrengths.pseudoknot=e,S.update()},S.displayBackground=function(e){S.displayParameters.displayBackground=e,S.updateStyle()},S.displayNumbering=function(e){S.displayParameters.displayNumbering=e,S.updateStyle()},S.displayNodeOutline=function(e){S.displayParameters.displayNodeOutline=e,S.updateStyle()},S.displayNodeLabel=function(e){S.displayParameters.displayNodeLabel=e,S.updateStyle()},S.displayLinks=function(e){S.displayParameters.displayLinks=e,S.updateStyle()},S.displayPseudoknotLinks=function(e){S.displayParameters.displayPseudoknotLinks=e,S.updateStyle()},S.displayProteinLinks=function(e){S.displayParameters.displayProteinLinks=e,S.updateStyle()},S.updateStyle=function(){X.selectAll("[node_type=label]").classed("transparent",!S.displayParameters.displayNumbering),X.selectAll("[label_type=label]").classed("transparent",!S.displayParameters.displayNumbering),R.selectAll("[linkType=label_link]").classed("transparent",!S.displayParameters.displayNumbering),C.selectAll("circle").classed("hidden_outline",!S.displayParameters.displayNodeOutline),X.selectAll("[label_type=nucleotide]").classed("transparent",!S.displayParameters.displayNodeLabel),C.selectAll("[link_type=real],[link_type=basepair],[link_type=backbone],[link_type=pseudoknot],[link_type=protein_chain],[link_type=chain_chain],[link_type=external]").classed("transparent",!S.displayParameters.displayLinks),C.selectAll("[link_type=pseudoknot]").classed("transparent",!S.displayParameters.displayPseudoknotLinks),C.selectAll("[link_type=protein_chain]").classed("transparent",!S.displayParameters.displayProteinLinks),R.selectAll("[link_type=fake]").classed("transparent",!S.options.displayAllLinks),R.selectAll("[link_type=fake_fake]").classed("transparent",!S.options.displayAllLinks)},S.createNewLinks=function(e){var t=e.append("svg:line");return t.append("svg:title").text(D),t.classed("link",!0).attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}).attr("link_type",function(e){return e.linkType}).attr("class",function(e){return d3.select(this).attr("class")+" "+e.linkType}).attr("pointer-events",function(e){return"fake"==e.linkType?"none":"all"}),t},S.createNewNodes=function(e){e=e.append("g").classed("noselect",!0).classed("gnode",!0).attr("struct_name",function(e){return e.structName}).attr("transform",function(e){return"undefined"!=typeof e.x&&"undefined"!=typeof e.y?"translate("+[e.x,e.y]+")":""}).each(function(e){e.selected=e.previouslySelected=!1}),e.call(z).on("mousedown",J).on("mousedrag",function(e){}).on("mouseup",W).attr("num",function(e){return"n"+e.num}).attr("rnum",function(e){return"n"+(e.rna.rnaLength-e.num+1)}).on("click",H).transition().duration(750).ease("elastic");var t=e.filter(function(e){return"label"==e.nodeType||"protein"==e.nodeType}),n=e.filter(function(e){return"nucleotide"==e.nodeType});t.append("svg:circle").attr("class","outline_node").attr("r",function(e){return e.radius+1}),n.append("svg:circle").attr("class","outline_node").attr("r",function(e){return e.radius+1}),t.append("svg:circle").attr("class","node").classed("label",function(e){return"label"==e.nodeType}).attr("r",function(e){return"middle"==e.nodeType?0:e.radius}).attr("node_type",function(e){return e.nodeType}).attr("node_num",function(e){return e.num}),n.append("svg:circle").attr("class","node").attr("node_type",function(e){return e.nodeType}).attr("node_num",function(e){return e.num}).attr("r",function(e){return e.radius}).append("svg:title").text(function(e){return"nucleotide"==e.nodeType?e.structName+":"+e.num:""}),n.append("svg:path").attr("class","node").attr("node_type",function(e){return e.nodeType}).attr("node_num",function(e){return e.num}).append("svg:title").text(function(e){return"nucleotide"==e.nodeType?e.structName+":"+e.num:""});var r=e.append("text").text(function(e){return e.name}).attr("text-anchor","middle").attr("font-size",8).attr("font-weight","bold").attr("y",2.5).attr("class","node-label").attr("label_type",function(e){return e.nodeType});return r.append("svg:title").text(function(e){return"nucleotide"==e.nodeType?e.structName+":"+e.num:""}),e};S.update=function(){S.force.nodes(S.graph.nodes).links(S.graph.links),S.animation&&S.force.start();var e=R.selectAll("line.link").data(S.graph.links.filter(l),D);e.attr("class","").classed("link",!0).attr("link_type",function(e){return e.linkType}).attr("class",function(e){return d3.select(this).attr("class")+" "+e.linkType});var t=e.enter();S.createNewLinks(t),e.exit().remove();var n=[0,1,2,3,4,5,6,7,8,9],r=(d3.scale.category10().domain(n),X.selectAll("g.gnode").data(S.graph.nodes,U)),i=r.enter();S.createNewNodes(i),r.exit().remove();var s,a=S.graph.nodes.filter(function(e){return"nucleotide"==e.nodeType||"label"==e.nodeType});s=S.displayFakeLinks?e:R.selectAll("[link_type=real],[link_type=pseudoknot],[link_type=protein_chain],[link_type=chain_chain],[link_type=label_link],[link_type=backbone],[link_type=basepair],[link_type=intermolecule],[link_type=external]");r.selectAll("path").each(o),s.on("click",V),S.force.on("tick",function(){for(var e=d3.geom.quadtree(a),t=0,n=a.length;++t<n;)e.visit(x(a[t]));s.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),r.attr("transform",function(e){return"translate("+[e.x,e.y]+")"}),r.select("path").each(o)}),S.force.on("end",function(){r.selectAll("[node_type=nucleotide]").filter(function(e,t){return 0==t}).each(function(e,t){});for(var e in S.rnas)for(var t=1;t<S.rnas[e].pairtable[0];t++);}),S.changeColorScheme(S.colorScheme),S.animation&&S.force.start(),S.updateStyle()},S.setSize()}Object.defineProperty(t,"__esModule",{value:!0}),t.FornaContainer=o,n(1);var s=n(5),a=(n(7),n(6)),u=n(8);n(14)},function(e,t,n){var r=n(2);"string"==typeof r&&(r=[[e.id,r,""]]);n(4)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(3)(),t.push([e.id,"svg {\n  display: block;\n  min-width: 100%;\n  width: 100%;\n  min-height: 100%;\n}\n\ncircle.node {\n  stroke: #ccc;\n  stroke-width: 1px;\n  opacity: 1;\n  fill: white;\n}\n\npolygon.node {\n  stroke: #ccc;\n  stroke-width: 1px;\n  opacity: 1;\n  fill: white;\n}\n\ncircle.node.label {\n    stroke: transparent;\n    stroke-width: 0;\n    fill: white;\n    display: inline;\n}\n\ncircle.outline_node {\n    stroke-width: 1px;\n    fill: red;\n}\n\ncircle.protein {\n    fill: gray;\n    fill-opacity: 0.5;\n    stroke-width: 4;\n}\n\ncircle.hidden_outline {\n    stroke-width: 0px;\n}\n\n\nline.link {\n  stroke: #999;\n  stroke-opacity: 0.8;\n  stroke-width: 2;\n}\n\nline.pseudoknot {\n    stroke: red;\n}\n\nline.basepair {\n  stroke: red;\n}\n\nline.intermolecule {\n  stroke: blue;\n}\n\nline.chain_chain {\n  stroke-dasharray: 3,3;\n}\n\nline.fake {\n  stroke: green;\n}\n\n.transparent {\n    fill: transparent;\n    stroke-width: 0;\n    stroke-opacity: 0;\n    opacity: 0;\n    visibility: hidden;\n}\n\n.drag_line {\n  stroke: #999;\n  stroke-width: 2;\n  pointer-events: none;\n}\n\n.drag_line_hidden {\n  stroke: #999;\n  stroke-width: 0;\n  pointer-events: none;\n}\n\n.d3-tip {\n    line-height: 1;\n    font-weight: bold;\n    padding: 6px;\n    background: rgba(0, 0, 0, 0.6);\n    color: #fff;\n    border-radius: 4px;\n    pointer-events: none;\n          }\n\ntext.node-label {\n    font-weight: bold;\n    font-family: Tahoma, Geneva, sans-serif;\n    color: rgb(100,100,100);\n    pointer-events: none;\n}\n\ntext {\n    pointer-events: none;\n}\n\ng.gnode {\n\n}\n\ncircle.outline_node.selected {\n    visibility: visible;\n}\n\ncircle.outline_node {\n    visibility: hidden;\n}\n\n.brush .extent {\n  fill-opacity: .1;\n  stroke: #fff;\n  shape-rendering: crispEdges;\n}\n\n.noselect {\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -khtml-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}\n",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var s=t[o];"number"==typeof s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}},function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=h[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(l(r.parts[i],t))}else{for(var s=[],i=0;i<r.parts.length;i++)s.push(l(r.parts[i],t));h[r.id]={id:r.id,refs:1,parts:s}}}}function o(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],i=o[0],s=o[1],a=o[2],u=o[3],l={css:s,media:a,sourceMap:u};n[i]?n[i].parts.push(l):t.push(n[i]={id:i,parts:[l]})}return t}function i(e,t){var n=y(),r=m[m.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),m.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function s(e){e.parentNode.removeChild(e);var t=m.indexOf(e);t>=0&&m.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function u(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function l(e,t){var n,r,o;if(t.singleton){var i=b++;n=v||(v=a(t)),r=c.bind(null,n,i,!1),o=c.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(t),r=f.bind(null,n),o=function(){s(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(t),r=p.bind(null,n),o=function(){s(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function c(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=k(t,o);else{var i=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function p(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function f(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var h={},d=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},g=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),y=d(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,b=0,m=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=g()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=o(e);return r(n,t),function(e){for(var i=[],s=0;s<n.length;s++){var a=n[s],u=h[a.id];u.refs--,i.push(u)}if(e){var l=o(e);r(l,t)}for(var s=0;s<i.length;s++){var u=i[s];if(0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete h[u.id]}}}};var k=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){"use strict";function r(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t}function o(e,t,n){var o=this;o.type="protein",o.size=t,o.nodes=[{name:"P",num:1,radius:3*Math.sqrt(t),rna:o,nodeType:"protein",structName:e,elemType:"p",size:t,uid:r()}],o.links=[],o.uid=r(),o.addUids=function(e){for(var t=0;t<e.length;t++)o.nodes[t].uid=e[t];return o},o.getUids=function(){uids=[];for(var e=0;e<o.dotbracket.length;e++)uids.push(o.nodes[e].uid);return uids}}function i(e,t,n,o){var i=this;i.type="rna",i.circularizeExternal=!1,0===arguments.length?(i.seq="",i.dotbracket="",i.structName=""):(i.seq=e,i.dotbracket=t,i.structName=n),arguments.length<4&&(o=1),i.circular=!1,i.dotbracket.length>0&&"*"==i.dotbracket[i.dotbracket.length-1]&&(i.dotbracket=i.dotbracket.slice(0,i.dotbracket.length-1),i.circular=!0),i.uid=r(),i.elements=[],i.pseudoknotPairs=[],i.nucsToNodes={},i.addUids=function(e){for(var t=i.nodes.filter(function(e){return"nucleotide"==e.nodeType}),n=0;n<e.length&&n<t.length;n++)t[n].uid=e[n];return i},i.computePairtable=function(){i.pairtable=a.rnaUtilities.dotbracketToPairtable(i.dotbracket)},i.removeBreaks=function(e){for(var t=[],n=-1;(n=e.indexOf("&"))>=0;)t.push(n),e=e.substring(0,n)+"oo"+e.substring(n+1,e.length);return{targetString:e,breaks:t}};var s=i.removeBreaks(i.dotbracket);i.dotbracket=s.targetString,i.dotBracketBreaks=s.breaks,s=i.removeBreaks(i.seq),i.seq=s.targetString,i.seqBreaks=s.breaks,i.calculateStartNumberArray=function(){
i.startNumberArray=[];for(var e=0;e<i.dotbracket.length;e++)i.startNumberArray.push(o),"o"==i.dotbracket[e]&&(o=-e)},i.calculateStartNumberArray(),i.rnaLength=i.dotbracket.length,(0,a.arraysEqual)(i.dotBracketBreaks,i.seqBreaks)||(console.log("WARNING: Sequence and structure breaks not equal"),console.log("WARNING: Using the breaks in the structure")),i.computePairtable(),i.addPositions=function(e,t){for(var n=i.nodes.filter(function(t){return t.nodeType==e}),r=0;r<n.length;r++)n[r].x=t[r][0],n[r].px=t[r][0],n[r].y=t[r][1],n[r].py=t[r][1];return i},i.breakNodesToFakeNodes=function(){for(var e=i.nodes.filter(function(e){return"nucleotide"==e.nodeType}),t=0;t<e.length;t++)"o"==i.dotbracket[t]&&(e[t].nodeType="middle");for(var t=0;t<i.elements.length;t++){for(var n=!1,r=0;r<i.elements[t][2].length;r++)i.dotBracketBreaks.indexOf(i.elements[t][2][r])>=0&&(n=!0);n?i.elements[t][2].map(function(e){0!=e&&(i.nodes[e-1].elemType="e")}):i.elements[t][2].map(function(e){0!=e&&(i.nodes[e-1].elemType=i.elements[t][0])})}return i},i.getPositions=function(e){for(var t=[],n=i.nodes.filter(function(t){return t.nodeType==e}),r=0;r<n.length;r++)t.push([n[r].x,n[r].y]);return t},i.getUids=function(){for(var e=[],t=0;t<i.dotbracket.length;t++)e.push(i.nodes[t].uid);return e},i.reinforceStems=function(){for(var e=i.pairtable,t=i.elements.filter(function(e){return"s"==e[0]&&e[2].length>=4}),n=0;n<t.length;n++)for(var r=t[n][2],o=r.slice(0,r.length/2),s=0;s<o.length-1;s++)i.addFakeNode([o[s],o[s+1],e[o[s+1]],e[o[s]]]);return i},i.reinforceLoops=function(){for(var e=function(e){return 0!==e&&e<=i.dotbracket.length},t=0;t<i.elements.length;t++)if("s"!=i.elements[t][0]&&(i.circularizeExternal||"e"!=i.elements[t][0])){var n=i.elements[t][2].filter(e);if("e"==i.elements[t][0]){var o={name:"",num:-3,radius:0,rna:i,nodeType:"middle",elemType:"f",nucs:[],x:i.nodes[i.rnaLength-1].x,y:i.nodes[i.rnaLength-1].y,px:i.nodes[i.rnaLength-1].px,py:i.nodes[i.rnaLength-1].py,uid:r()},s={name:"",num:-2,radius:0,rna:i,nodeType:"middle",elemType:"f",nucs:[],x:i.nodes[0].x,y:i.nodes[0].y,px:i.nodes[0].px,py:i.nodes[0].py,uid:r()};n.push(i.nodes.length+1),n.push(i.nodes.length+2),i.nodes.push(o),i.nodes.push(s)}i.addFakeNode(n)}return i},i.updateLinkUids=function(){for(var e=0;e<i.links.length;e++)i.links[e].uid=i.links[e].source.uid+i.links[e].target.uid;return i},i.addFakeNode=function(e){for(var t=18,n=6.283/(2*e.length),o=t/(2*Math.tan(n)),s="",a=0;a<e.length;a++)s+=i.nodes[e[a]-1].uid;var u={name:"",num:-1,radius:o,rna:i,nodeType:"middle",elemType:"f",nucs:e,uid:s};i.nodes.push(u);var l=0,c=0,p=0;n=3.14159*(e.length-2)/(2*e.length),o=.5/Math.cos(n);for(var f=0;f<e.length;f++)if(!(0===e[f]||e[f]>i.dotbracket.length)){i.links.push({source:i.nodes[e[f]-1],target:i.nodes[i.nodes.length-1],linkType:"fake",value:o,uid:r()}),e.length>4&&i.links.push({source:i.nodes[e[f]-1],target:i.nodes[e[(f+Math.floor(e.length/2))%e.length]-1],linkType:"fake",value:2*o,uid:r()});var h=3.14159*(e.length-2)/e.length,d=2*Math.cos(1.570795-h/2);i.links.push({source:i.nodes[e[f]-1],target:i.nodes[e[(f+2)%e.length]-1],linkType:"fake",value:d});var g=i.nodes[e[f]-1];"x"in g&&(l+=g.x,c+=g.y,p+=1)}return p>0&&(u.x=l/p,u.y=c/p,u.px=u.x,u.py=u.y),i},i.connectFakeNodes=function(){for(var e=18,t=function(e){return"middle"==e.nodeType},n={},r=i.nodes.filter(t),o=new Set,s=1;s<=i.nodes.length;s++)n[s]=[];for(var s=0;s<r.length;s++)for(var a=r[s],u=0;u<a.nucs.length;u++){for(var l=a.nucs[u],c=0;c<n[l].length;c++)if(!o.has(JSON.stringify([n[l][c].uid,a.uid].sort()))){var p=n[l][c].radius+a.radius;i.links.push({source:n[l][c],target:a,value:p/e,linkType:"fake_fake"}),o.add(JSON.stringify([n[l][c].uid,a.uid].sort()))}n[l].push(a)}return i},i.addExtraLinks=function(e){if("undefined"==typeof e)return i;for(var t=0;t<e.length;t++){var n=i.getNodeFromNucleotides(e[t].from),o=i.getNodeFromNucleotides(e[t].to),s={source:n,target:o,linkType:"extra",extraLinkType:e[t].linkType,uid:r()};i.links.push(s)}return i},i.elementsToJson=function(){var e=i.pairtable;i.elements;i.nodes=[],i.links=[];var t={};i.elements.sort();for(var n=0;n<i.elements.length;n++)for(var o=i.elements[n][2],s=0;s<o.length;s++)t[o[s]]=i.elements[n][0];for(var n=1;n<=e[0];n++){var a=i.seq[n-1];(i.dotBracketBreaks.indexOf(n-1)>=0||i.dotBracketBreaks.indexOf(n-2)>=0)&&(a=""),i.nodes.push({name:a,num:n+i.startNumberArray[n-1]-1,radius:5,rna:i,nodeType:"nucleotide",structName:i.structName,elemType:t[n],uid:r(),linked:!1})}for(var n=0;n<i.nodes.length;n++)0===n?i.nodes[n].prevNode=null:i.nodes[n].prevNode=i.nodes[n-1],n==i.nodes.length-1?i.nodes[n].nextNode=null:i.nodes[n].nextNode=i.nodes[n+1];for(var n=1;n<=e[0];n++)0!==e[n]&&i.links.push({source:i.nodes[n-1],target:i.nodes[e[n]-1],linkType:"basepair",value:1,uid:r()}),n>1&&-1===i.dotBracketBreaks.indexOf(n-1)&&-1==i.dotBracketBreaks.indexOf(n-2)&&-1==i.dotBracketBreaks.indexOf(n-3)&&(i.links.push({source:i.nodes[n-2],target:i.nodes[n-1],linkType:"backbone",value:1,uid:r()}),i.nodes[n-1].linked=!0);for(var n=0;n<i.pseudoknotPairs.length;n++)i.links.push({source:i.nodes[i.pseudoknotPairs[n][0]-1],target:i.nodes[i.pseudoknotPairs[n][1]-1],linkType:"pseudoknot",value:1,uid:r()});return i.circular&&i.links.push({source:i.nodes[0],target:i.nodes[i.rnaLength-1],linkType:"backbone",value:1,uid:r()}),i},i.ptToElements=function(e,t,n,r){var o=[],s=[n-1],a=[r+1];if(n>r)return[];for(;0===e[n];n++)s.push(n);for(;0===e[r];r--)a.push(r);if(n>r){if(s.push(n),0===t)return[["e",t,s.sort(u)]];for(var l=!1,c=[],p=[],f=0;f<s.length;f++)l?p.push(s[f]):c.push(s[f]),i.dotBracketBreaks.indexOf(s[f])>=0&&(l=!0);return l?[["h",t,s.sort(u)]]:[["h",t,s.sort(u)]]}if(e[n]!=r){var h=s,f=n;for(h.push(f);r>=f;){for(o=o.concat(i.ptToElements(e,t,f,e[f])),h.push(e[f]),f=e[f]+1;0===e[f]&&r>=f;f++)h.push(f);h.push(f)}return h.pop(),h=h.concat(a),h.length>0&&(0===t?o.push(["e",t,h.sort(u)]):o.push(["m",t,h.sort(u)])),o}if(e[n]===r){s.push(n),a.push(r);var d=s.concat(a);d.length>4&&(0===t?o.push(["e",t,s.concat(a).sort(u)]):o.push(["i",t,s.concat(a).sort(u)]))}for(var g=[];e[n]===r&&r>n;)g.push(n),g.push(r),n+=1,r-=1,t+=1;return s=[n-1],a=[r+1],o.push(["s",t,g.sort(u)]),o.concat(i.ptToElements(e,t,n,r))},i.addLabels=function(e,t){if(0===arguments.length&&(e=1,t=10),1===arguments.length&&(t=10),0===t)return i;0>=t&&console.log("The label interval entered in invalid:",t);for(var n=1;n<=i.pairtable[0];n++)if(n%t===0){var o,s,a,u,l,c,p=i.nodes[n-1];1==i.rnaLength?(c=[p.x-15,p.y],l=[p.x-15,p.y]):(a=1==n?i.nodes[i.rnaLength-1]:i.nodes[n-2],u=n==i.rnaLength?i.nodes[0]:i.nodes[n],0!==i.pairtable[u.num]&&0!==i.pairtable[a.num]&&0!==i.pairtable[p.num]&&(a=u=i.nodes[i.pairtable[p.num]-1]),0===i.pairtable[p.num]||0!==i.pairtable[u.num]&&0!==i.pairtable[a.num]?(c=[u.x-p.x,u.y-p.y],l=[a.x-p.x,a.y-p.y]):(c=[p.x-u.x,p.y-u.y],l=[p.x-a.x,p.y-a.y]));var f=[c[0]+l[0],c[1]+l[1]],h=Math.sqrt(f[0]*f[0]+f[1]*f[1]),d=[f[0]/h,f[1]/h],g=[-15*d[0],-15*d[1]],o=i.nodes[n-1].x+g[0],s=i.nodes[n-1].y+g[1],y={name:n+i.startNumberArray[n-1]-1,num:-1,radius:6,rna:i,nodeType:"label",structName:i.structName,elemType:"l",x:o,y:s,px:o,py:s,uid:r()},v={source:i.nodes[n-1],target:y,value:1,linkType:"label_link",uid:r()};i.nodes.push(y),i.links.push(v)}return i},i.recalculateElements=function(){if(i.removePseudoknots(),i.elements=i.ptToElements(i.pairtable,0,1,i.dotbracket.length),i.circular&&(externalLoop=i.elements.filter(function(e){return"e"==e[0]?!0:void 0}),externalLoop.length>0)){eloop=externalLoop[0],nucs=eloop[2].sort(u),prev=nucs[0],hloop=!0,numGreater=0;for(var e=1;e<nucs.length;e++)nucs[e]-prev>1&&(numGreater+=1),prev=nucs[e];1==numGreater?eloop[0]="h":2==numGreater?eloop[0]="i":eloop[0]="m"}return i},i.reassignLinkUids=function(){for(var e,e=0;e<i.links.length;e++)i.links[e].uid=i.links[e].source.uid+i.links[e].target.uid;return i},i.removePseudoknots=function(){return i.pairtable.length>1&&(i.pseudoknotPairs=i.pseudoknotPairs.concat(a.rnaUtilities.removePseudoknotsFromPairtable(i.pairtable))),i},i.addPseudoknots=function(){for(var e=i.pairtable,t=i.pseudoknotPairs,n=0;n<t.length;n++)e[t[n][0]]=t[n][1],e[t[n][1]]=t[n][0];return i.pseudoknotPairs=[],i},i.addName=function(e){return"undefined"==typeof e?(i.name="",i):(i.name=e,i)},i.rnaLength>0&&i.recalculateElements()}function s(e){for(var t={},n=[],s=[],a=0;a<e.molecules.length;a++){var u,l=e.molecules[a];"rna"==l.type?(u=new i(l.seq,l.ss,l.header),u.circularizeExternal=!0,u.elementsToJson().addPositions("nucleotide",l.positions).addLabels().reinforceStems().reinforceLoops()):"protein"==l.type&&(u=new o(l.header,l.size)),u.addUids(l.uids);for(var c=0;c<u.nodes.length;c++)t[u.nodes[c].uid]=u.nodes[c];n.push(u)}for(var a=0;a<e.extraLinks.length;a++)link=e.extraLinks[a],link.source=t[link.source],link.target=t[link.target],link.uid=r(),s.push(link);return{graphs:n,extraLinks:s}}Object.defineProperty(t,"__esModule",{value:!0}),t.ProteinGraph=o,t.RNAGraph=i,t.moleculesToJson=s;var a=n(6),u=function(e,t){return e-t};"undefined"==typeof String.prototype.trim&&(String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")})},function(e,t,n){!function(t,n){e.exports=n()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t){"use strict";function n(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function r(){var e=this;e.bracketLeft="([{<ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),e.bracketRight=")]}>abcdefghijklmnopqrstuvwxyz".split(""),e.inverseBrackets=function(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=n;return t},e.maximumMatching=function(e){for(var t=e[0],n=0,r=new Array(t+1),o=0;t>=o;o++){r[o]=new Array(t+1);for(var i=o;t>=i;i++)r[o][i]=0}for(var s=0,o=t-n-1;o>0;o--)for(var i=o+n+1;t>=i;i++){s=r[o][i-1];for(var a=i-n-1;a>=o;a--)e[a]===i&&(s=Math.max(s,(a>o?r[o][a-1]:0)+1+(i-a-1>0?r[a+1][i-1]:0)));r[o][i]=s}return s=r[1][t],r},e.backtrackMaximumMatching=function(t,n){var r=Array.apply(null,Array(t.length)).map(function(){return 0});return e.mmBt(t,r,n,1,t.length-1),r},e.mmBt=function(t,n,r,o,i){var s=t[o][i],a=0;if(!(a>i-o-1)){if(t[o][i-1]==s)return void e.mmBt(t,n,r,o,i-1);for(var u=i-a-1;u>=o;u--)if(r[i]===u){var l=u>o?t[o][u-1]:0,c=i-u-1>0?t[u+1][i-1]:0;if(l+c+1==s)return n[u]=i,n[i]=u,u>o&&e.mmBt(t,n,r,o,u-1),void e.mmBt(t,n,r,u+1,i-1)}console.log("FAILED!!!"+o+","+i+": backtracking failed!")}},e.dotbracketToPairtable=function(t){var n=Array.apply(null,new Array(t.length+1)).map(Number.prototype.valueOf,0);n[0]=t.length;for(var r={},o=0;o<e.bracketLeft.length;o++)r[o]=[];for(var i=e.inverseBrackets(e.bracketLeft),s=e.inverseBrackets(e.bracketRight),o=0;o<t.length;o++){var a=t[o],u=o+1;if("."==a||"o"==a)n[u]=0;else if(a in i)r[i[a]].push(u);else{if(!(a in s))throw"Unknown symbol in dotbracket string";var l=r[s[a]].pop();n[u]=l,n[l]=u}}for(var c in r)if(r[c].length>0)throw"Unmatched base at position "+r[c][0];return n},e.insertIntoStack=function(e,t,n){for(var r=0;e[r].length>0&&e[r][e[r].length-1]<n;)r+=1;return e[r].push(n),r},e.deleteFromStack=function(e,t){for(var n=0;0===e[n].length||e[n][e[n].length-1]!=t;)n+=1;return e[n].pop(),n},e.pairtableToDotbracket=function(t){for(var n={},r=0;r<t[0];r++)n[r]=[];for(var r,o={},i="",r=1;r<t[0]+1;r++){if(0!==t[r]&&t[r]in o)throw"Invalid pairtable contains duplicate entries";o[t[r]]=!0,i+=0===t[r]?".":t[r]>r?e.bracketLeft[e.insertIntoStack(n,r,t[r])]:e.bracketRight[e.deleteFromStack(n,r)]}return i},e.findUnmatched=function(t,n,r){for(var o,i=[],s=[],a=n,u=r,o=n;r>=o;o++)0!==t[o]&&(t[o]<n||t[o]>r)&&s.push([o,t[o]]);for(var o=a;u>=o;o++){for(;0===t[o]&&u>=o;)o++;for(r=t[o];t[o]===r;)o++,r--;i=i.concat(e.findUnmatched(t,o,r))}return s.length>0&&i.push(s),i},e.removePseudoknotsFromPairtable=function(t){for(var n=e.maximumMatching(t),r=e.backtrackMaximumMatching(n,t),o=[],i=1;i<t.length;i++)t[i]<i||r[i]!=t[i]&&(o.push([i,t[i]]),t[t[i]]=0,t[i]=0);return o},e.ptToElements=function(t,n,r,o,s){var a=[],u=[r-1],l=[o+1];if(arguments.length<5&&(s=[]),r>o)return[];for(;0===t[r];r++)u.push(r);for(;0===t[o];o--)l.push(o);if(r>o){if(u.push(r),0===n)return[["e",n,u.sort(i)]];for(var c=!1,p=[],f=[],h=0;h<u.length;h++)c?f.push(u[h]):p.push(u[h]),s.indexOf(u[h])>=0&&(c=!0);return c?[["h",n,u.sort(i)]]:[["h",n,u.sort(i)]]}if(t[r]!=o){var d=u,h=r;for(d.push(h);o>=h;){for(a=a.concat(e.ptToElements(t,n,h,t[h],s)),d.push(t[h]),h=t[h]+1;0===t[h]&&o>=h;h++)d.push(h);d.push(h)}return d.pop(),d=d.concat(l),d.length>0&&(0===n?a.push(["e",n,d.sort(i)]):a.push(["m",n,d.sort(i)])),a}if(t[r]===o){u.push(r),l.push(o);var g=u.concat(l);g.length>4&&(0===n?a.push(["e",n,u.concat(l).sort(i)]):a.push(["i",n,u.concat(l).sort(i)]))}for(var y=[];t[r]===o&&o>r;)y.push(r),y.push(o),r+=1,o-=1,n+=1;return u=[r-1],l=[o+1],a.push(["s",n,y.sort(i)]),a.concat(e.ptToElements(t,n,r,o,s))}}function o(e){var t=this;return t.colorsText=e,t.parseRange=function(e){for(var t=e.split(","),n=[],r=0;r<t.length;r++){var o=t[r].split("-");if(1==o.length)n.push(parseInt(o[0]));else if(2==o.length)for(var i=parseInt(o[0]),s=parseInt(o[1]),a=i;s>=a;a++)n.push(a);else console.log("Malformed range (too many dashes):",e)}return n},t.parseColorText=function(e){for(var n=e.split("\n"),r="",o=1,i={colorValues:{"":{}},range:["white","steelblue"]},s=[],a=0;a<n.length;a++)if(">"!=n[a][0])for(var u=n[a].trim().split(/[\s]+/),l=0;l<u.length;l++)if(isNaN(u[l])){if(0===u[l].search("range")){var c=u[l].split("="),p=c[1].split(":");i.range=[p[0],p[1]];continue}if(0==u[l].search("domain")){var f=u[l].split("="),p=f[1].split(":");i.domain=[p[0],p[1]];continue}for(var h=u[l].split(":"),d=t.parseRange(h[0]),g=h[1],y=0;y<d.length;y++)isNaN(g)?i.colorValues[r][d[y]]=g:(i.colorValues[r][d[y]]=+g,s.push(Number(g)))}else i.colorValues[r][o]=Number(u[l]),o+=1,s.push(Number(u[l]));else r=n[a].trim().slice(1),o=1,i.colorValues[r]={};return"domain"in i||(i.domain=[Math.min.apply(null,s),Math.max.apply(null,s)]),t.colorsJson=i,t},t.normalizeColors=function(){var e;for(var n in t.colorsJson){var r=Number.MAX_VALUE,o=Number.MIN_VALUE;for(var i in t.colorsJson.colorValues[n])e=t.colorsJson.colorValues[n][i],"number"==typeof e&&(r>e&&(r=e),e>o&&(o=e));for(i in t.colorsJson.colorValues[n])e=t.colorsJson.colorValues[n][i],"number"==typeof e&&(t.colorsJson.colorValues[n][i]=(e-r)/(o-r))}return t},t.parseColorText(t.colorsText),t}Object.defineProperty(t,"__esModule",{value:!0}),t.arraysEqual=n,t.RNAUtilities=r,t.ColorScheme=o;var i=function(e,t){return e-t};t.rnaUtilities=new r}])})},function(e,t){"use strict";function n(e){var t,n,r,o=0,i=100,s=100,a=15,u=[],l=[];n=e[0];var c=Array.apply(null,new Array(n+5)).map(Number.prototype.valueOf,0),p=Array.apply(null,new Array(16+Math.floor(n/5))).map(Number.prototype.valueOf,0),f=Array.apply(null,new Array(16+Math.floor(n/5))).map(Number.prototype.valueOf,0),h=0,d=0,g=Math.PI/2,y=function b(e,t,n){var r,o,i,s,a,u,l,y,v,m,k,x,w=2,O=0,S=0,T=Array.apply(null,new Array(3+2*Math.floor((t-e)/5))).map(Number.prototype.valueOf,0);for(r=e-1,t++;e!=t;)if(o=n[e],o&&0!=e){w+=2,i=e,s=o,T[++O]=i,T[++O]=s,e=o+1,a=i,u=s,y=0;do i++,s--,y++;while(n[i]==s&&n[i]>i);if(l=y-2,y>=2&&(c[a+1+l]+=g,c[u-1-l]+=g,c[a]+=g,c[u]+=g,y>2))for(;l>=1;l--)c[a+l]=Math.PI,c[u-l]=Math.PI;f[++d]=y,s>=i&&b(i,s,n)}else e++,w++,S++;for(x=Math.PI*(w-2)/w,T[++O]=t,v=0>r?0:r,m=1;O>=m;m++){for(k=T[m]-v,l=0;k>=l;l++)c[v+l]+=x;if(m>O)break;v=T[++m]}p[++h]=S};y(0,n+1,e),p[h]-=2,r=o,u[0]=i,l[0]=s;var v=[];for(v.push([u[0],l[0]]),t=1;n>t;t++)u[t]=u[t-1]+a*Math.cos(r),l[t]=l[t-1]+a*Math.sin(r),v.push([u[t],l[t]]),r+=Math.PI-c[t+1];return v}Object.defineProperty(t,"__esModule",{value:!0}),t.simpleXyCoordinates=n},function(e,t,n){"use strict";function r(){this.ANUM=9999,this.MAXITER=500,this.bases=[],this.nbase=null,this.nregion=null,this.loop_count=null,this.root=new c.Loop,this.loops=[],this.regions=[],this.rlphead=new s.Radloop,this.lencut=.8,this.RADIUS_REDUCTION_FACTOR=1.4,this.angleinc=null,this._h=null,this.HELIX_FACTOR=.6,this.BACKBONE_DISTANCE=27}function o(){var e=new c.Loop,t=null,n=null;for(t=0;t<this.loop_count;t++){for(e=this.loops[t],n=0;n<this.loop_count;n++)this.loops[n].setMark(!1);e.setDepth(i(e))}}function i(e){var t=null,n=null,r=null;if(e.getNconnection()<=1)return 0;if(e.isMark())return-1;e.setMark(!0),t=0,n=0;for(var o=0;null!=e.getConnection(o);o++)r=i(e.getConnection(o).getLoop()),r>=0&&(1==++t?n=r:n>r&&(n=r));return e.setMark(!1),n+1}Object.defineProperty(t,"__esModule",{value:!0}),t.NAView=r;var s=n(9),a=n(10),u=n(12),l=n(13),c=n(11);r.prototype.naview_xy_coordinates=function(e){var t=[],n=[];if(0===e.length||0===e[0])return 0;var r;this.nbase=e[0],this.bases=[];for(var o=0;o<this.nbase+1;o++)this.bases.push(new l.Base);this.regions=[];for(var o=0;o<this.nbase+1;o++)this.regions.push(new u.Region);this.read_in_bases(e),this.rlphead=null,this.find_regions(),this.loop_count=0,this.loops=[];for(var o=0;o<this.nbase+1;o++)this.loops.push(new c.Loop);for(this.construct_loop(0),this.find_central_loop(),this.traverse_loop(this.root,null),r=0;r<this.nbase;r++)t.push(100+this.BACKBONE_DISTANCE*this.bases[r+1].getX()),n.push(100+this.BACKBONE_DISTANCE*this.bases[r+1].getY());return{nbase:this.nbase,x:t,y:n}},r.prototype.read_in_bases=function(e){var t=null,n=null;for(this.bases.push(new l.Base),this.bases[0].setMate(0),this.bases[0].setExtracted(!1),this.bases[0].setX(this.ANUM),this.bases[0].setY(this.ANUM),n=0,t=1;t<=this.nbase;t++)this.bases.push(new l.Base),this.bases[t].setExtracted(!1),this.bases[t].setX(this.ANUM),this.bases[t].setY(this.ANUM),this.bases[t].setMate(e[t]),e[t]>t&&n++;0==n&&(this.bases[1].setMate(this.nbase),this.bases[this.nbase].setMate(1))},r.prototype.find_regions=function(){var e=null,t=null,n=null;n=this.nbase+1;var r=[];for(e=0;n>e;e++)r.push(!1);for(this.nregion=0,e=0;e<=this.nbase;e++)if(0!=(t=this.bases[e].getMate())&&!r[e]){for(this.regions[this.nregion].setStart1(e),this.regions[this.nregion].setEnd2(t),r[e]=!0,r[t]=!0,this.bases[e].setRegion(this.regions[this.nregion]),this.bases[t].setRegion(this.regions[this.nregion]),e++,t--;t>e&&this.bases[e].getMate()==t;e++,t--)r[t]=!0,r[e]=!0,this.bases[e].setRegion(this.regions[this.nregion]),this.bases[t].setRegion(this.regions[this.nregion]);this.regions[this.nregion].setEnd1(--e),this.regions[this.nregion].setStart2(t+1),this.nregion++}},r.prototype.construct_loop=function(e){var t=null,n=null,r=new c.Loop,o=new c.Loop,i=new a.Connection,l=new u.Region,p=new s.Radloop;for(r=this.loops[this.loop_count++],r.setNconnection(0),r.setDepth(0),r.setNumber(this.loop_count),r.setRadius(0),p=this.rlphead;null!=p;p=p.getNext())p.getLoopnumber()==this.loop_count&&r.setRadius(p.getRadius());t=e;do 0!=(n=this.bases[t].getMate())&&(l=this.bases[t].getRegion(),this.bases[l.getStart1()].isExtracted()||(t==l.getStart1()?(this.bases[l.getStart1()].setExtracted(!0),this.bases[l.getEnd1()].setExtracted(!0),this.bases[l.getStart2()].setExtracted(!0),this.bases[l.getEnd2()].setExtracted(!0),o=this.construct_loop(l.getEnd1()<this.nbase?l.getEnd1()+1:0)):t==l.getStart2()?(this.bases[l.getStart2()].setExtracted(!0),this.bases[l.getEnd2()].setExtracted(!0),this.bases[l.getStart1()].setExtracted(!0),this.bases[l.getEnd1()].setExtracted(!0),o=this.construct_loop(l.getEnd2()<this.nbase?l.getEnd2()+1:0)):console.log("Something went terribly wrong ...."),r.setNconnection(r.getNconnection()+1),i=new a.Connection,r.setConnection(r.getNconnection()-1,i),r.setConnection(r.getNconnection(),null),i.setLoop(o),i.setRegion(l),t==l.getStart1()?(i.setStart(l.getStart1()),i.setEnd(l.getEnd2())):(i.setStart(l.getStart2()),i.setEnd(l.getEnd1())),i.setExtruded(!1),i.setBroken(!1),o.setNconnection(o.getNconnection()+1),i=new a.Connection,o.setConnection(o.getNconnection()-1,i),o.setConnection(o.getNconnection(),null),i.setLoop(r),i.setRegion(l),t==l.getStart1()?(i.setStart(l.getStart2()),i.setEnd(l.getEnd1())):(i.setStart(l.getStart1()),i.setEnd(l.getEnd2())),i.setExtruded(!1),i.setBroken(!1)),t=n),++t>this.nbase&&(t=0);while(t!=e);return r},r.prototype.find_central_loop=function(){var e=new c.Loop,t=null,n=null,r=null;for(o.bind(this)(),t=0,n=-1,r=0;r<this.loop_count;r++)e=this.loops[r],e.getNconnection()>t?(n=e.getDepth(),t=e.getNconnection(),this.root=e):e.getDepth()>n&&e.getNconnection()==t&&(n=e.getDepth(),this.root=e)},r.prototype.traverse_loop=function(e,t){var n,r,o,i,s,a,u,l,c,p,f,h,d,g,y,v,b,m,k,x,w,O,S,T,E,N,M,j,_,P,C,A,I,L,R,X,F,Y,B,z,D,U,q,G,V,H,W,J,$,Z,K,Q,ee,te,ne,re,oe,ie,se,ae,ue,le,ce,pe,fe,he,de,ge,ye,ve,be,me=0;u=2*Math.PI/(this.nbase+1),k=null,C=-1;var ke=0;for(T=0;null!=(b=e.getConnection(ke));ke++,T++)n=-Math.sin(u*b.getStart()),r=Math.cos(u*b.getStart()),o=-Math.sin(u*b.getEnd()),i=Math.cos(u*b.getEnd()),s=i-r,a=n-o,l=Math.sqrt(s*s+a*a),b.setXrad(s/l),b.setYrad(a/l),b.setAngle(Math.atan2(a,s)),b.getAngle()<0&&b.setAngle(b.getAngle()+2*Math.PI),null!=t&&t.getRegion()==b.getRegion()&&(k=b,C=T);e:for(;;){this.determine_radius(e,this.lencut),c=e.getRadius()/this.RADIUS_REDUCTION_FACTOR,null==t?p=f=0:(h=(this.bases[k.getStart()].getX()+this.bases[k.getEnd()].getX())/2,d=(this.bases[k.getStart()].getY()+this.bases[k.getEnd()].getY())/2,p=h-c*k.getXrad(),f=d-c*k.getYrad()),j=-1==C?0:C,b=e.getConnection(j),M=0,A=!1;do if(O=j-1,0>O&&(O=e.getNconnection()-1),x=e.getConnection(O),this.connected_connection(x,b)?(j=O,b=x):A=!0,++M>e.getNconnection()){for(N=-1,T=0;T<e.getNconnection();T++)O=T+1,O>=e.getNconnection()&&(O=0),b=e.getConnection(T),m=e.getConnection(O),de=m.getAngle()-b.getAngle(),0>de&&(de+=2*Math.PI),de>N&&(N=de,me=T);_=me,j=me+1,j>=e.getNconnection()&&(j=0),b=e.getConnection(_),b.setBroken(!0),A=!0}while(!A);for(I=!1,W=j;!I;){for(M=0,A=!1,_=j,L=!1;!A;)if(b=e.getConnection(_),_==C&&(L=!0),O=_+1,O>=e.getNconnection()&&(O=0),m=e.getConnection(O),this.connected_connection(b,m)){if(++M>=e.getNconnection())break;_=O}else A=!0;for(P=this.find_ic_middle(j,_,t,k,e),T=J=$=P,A=!1,K=0;!A;)T=0>K?J:0==K?P:$,T>=0&&(b=e.getConnection(T),null!=t&&k==b||(0==K?(g=b.getAngle()-Math.asin(.5/c),y=b.getAngle()+Math.asin(.5/c),this.bases[b.getStart()].setX(p+c*Math.cos(g)),this.bases[b.getStart()].setY(f+c*Math.sin(g)),this.bases[b.getEnd()].setX(p+c*Math.cos(y)),this.bases[b.getEnd()].setY(f+c*Math.sin(y))):0>K?(O=T+1,O>=e.getNconnection()&&(O=0),b=e.getConnection(T),m=e.getConnection(O),re=b.getXrad(),oe=b.getYrad(),de=(b.getAngle()+m.getAngle())/2,b.getAngle()>m.getAngle()&&(de-=Math.PI),ae=Math.cos(de),ue=Math.sin(de),pe=ue,fe=-ae,E=m.getAngle()-b.getAngle(),0>E&&(E+=2*Math.PI),he=b.isExtruded()?E<=Math.PI/2?2:1.5:1,this.bases[b.getEnd()].setX(this.bases[m.getStart()].getX()+he*pe),this.bases[b.getEnd()].setY(this.bases[m.getStart()].getY()+he*fe),this.bases[b.getStart()].setX(this.bases[b.getEnd()].getX()+oe),this.bases[b.getStart()].setY(this.bases[b.getEnd()].getY()-re)):(O=T-1,0>O&&(O=e.getNconnection()-1),b=e.getConnection(O),m=e.getConnection(T),ie=m.getXrad(),se=m.getYrad(),de=(b.getAngle()+m.getAngle())/2,b.getAngle()>m.getAngle()&&(de-=Math.PI),ae=Math.cos(de),ue=Math.sin(de),pe=-ue,fe=ae,E=m.getAngle()-b.getAngle(),0>E&&(E+=2*Math.PI),he=b.isExtruded()?E<=Math.PI/2?2:1.5:1,this.bases[m.getStart()].setX(this.bases[b.getEnd()].getX()+he*pe),this.bases[m.getStart()].setY(this.bases[b.getEnd()].getY()+he*fe),this.bases[m.getEnd()].setX(this.bases[m.getStart()].getX()-se),this.bases[m.getEnd()].setY(this.bases[m.getStart()].getY()+ie)))),0>K?($==_?$=-1:$>=0&&++$>=e.getNconnection()&&($=0),K=1):(J==j?J=-1:J>=0&&--J<0&&(J=e.getNconnection()-1),K=-1),A=-1==J&&-1==$;if(Z=_+1,Z>=e.getNconnection()&&(Z=0),_!=j&&(j!=W||Z!=W))if(b=e.getConnection(j),m=e.getConnection(_),ee=this.bases[m.getEnd()].getX()-this.bases[b.getStart()].getX(),te=this.bases[m.getEnd()].getY()-this.bases[b.getStart()].getY(),X=this.bases[b.getStart()].getX()+ee/2,F=this.bases[b.getStart()].getY()+te/2,ne=Math.sqrt(ee*ee+te*te),z=ee/ne,D=te/ne,U=p-X,q=f-F,ne=Math.sqrt(ee*ee+te*te),U/=ne,q/=ne,G=U*z+q*D,Y=G*z-U,B=G*D-q,ne=Math.sqrt(Y*Y+B*B),Y/=ne,B/=ne,ee=this.bases[b.getStart()].getX()-p,te=this.bases[b.getStart()].getY()-f,de=Math.atan2(te,ee),0>de&&(de+=2*Math.PI),ee=this.bases[m.getEnd()].getX()-p,te=this.bases[m.getEnd()].getY()-f,ge=Math.atan2(te,ee),0>ge&&(ge+=2*Math.PI),de>ge&&(ge+=2*Math.PI),R=ge-de>Math.PI?-1:1,V=p+R*c*Y,H=f+R*c*B,L)p-=V-X,f-=H-F;else for(T=j;b=e.getConnection(T),w=b.getStart(),this.bases[w].setX(this.bases[w].getX()+V-X),this.bases[w].setY(this.bases[w].getY()+H-F),w=b.getEnd(),this.bases[w].setX(this.bases[w].getX()+V-X),this.bases[w].setY(this.bases[w].getY()+H-F),T!=_;)++T>=e.getNconnection()&&(T=0);j=Z,I=j==W}for(T=0;T<e.getNconnection();T++){if(b=e.getConnection(T),O=T+1,O>=e.getNconnection()&&(O=0),m=e.getConnection(O),ee=this.bases[b.getEnd()].getX()-p,te=this.bases[b.getEnd()].getY()-f,ce=Math.sqrt(ee*ee+te*te),de=Math.atan2(te,ee),0>de&&(de+=2*Math.PI),ee=this.bases[m.getStart()].getX()-p,te=this.bases[m.getStart()].getY()-f,le=Math.sqrt(ee*ee+te*te),ge=Math.atan2(te,ee),0>ge&&(ge+=2*Math.PI),de>ge&&(ge+=2*Math.PI),Q=ge-de,be=m.getAngle()-b.getAngle(),0>=be&&(be+=2*Math.PI),Math.abs(Q-be)>Math.PI)if(b.isExtruded())console.log("Warning from traverse_loop. Loop "+e.getNumber()+" has crossed regions\n");else if(m.getStart()-b.getEnd()!=1){b.setExtruded(!0);continue e}if(b.isExtruded())this.construct_extruded_segment(b,m);else for(S=m.getStart()-b.getEnd(),0>S&&(S+=this.nbase+1),u=Q/S,O=1;S>O;O++)w=b.getEnd()+O,w>this.nbase&&(w-=this.nbase+1),v=de+O*u,ne=ce+(le-ce)*(v-de)/Q,this.bases[w].setX(p+ne*Math.cos(v)),this.bases[w].setY(f+ne*Math.sin(v))}break}for(T=0;T<e.getNconnection();T++)C!=T&&(b=e.getConnection(T),this.generate_region(b),this.traverse_loop(b.getLoop(),b));for(S=0,ye=0,ve=0,T=0;T<e.getNconnection();T++)if(O=T+1,O>=e.getNconnection()&&(O=0),b=e.getConnection(T),m=e.getConnection(O),S+=2,ye+=this.bases[b.getStart()].getX()+this.bases[b.getEnd()].getX(),ve+=this.bases[b.getStart()].getY()+this.bases[b.getEnd()].getY(),!b.isExtruded())for(O=b.getEnd()+1;O!=m.getStart();O++)O>this.nbase&&(O-=this.nbase+1),S++,ye+=this.bases[O].getX(),ve+=this.bases[O].getY();e.setX(ye/S),e.setY(ve/S)},r.prototype.determine_radius=function(e,t){var n,r,o,i,s,u,l,c,p,f,h,d=0,g=new a.Connection,y=new a.Connection,v=.7071068;do{for(n=1e10,s=0,i=0,c=0;c<e.getNconnection();c++)g=e.getConnection(c),p=c+1,p>=e.getNconnection()&&(p=0),y=e.getConnection(p),f=g.getEnd(),h=y.getStart(),f>h&&(h+=this.nbase+1),o=y.getAngle()-g.getAngle(),0>=o&&(o+=2*Math.PI),r=g.isExtruded()?o<=Math.PI/2?2:1.5:h-f,i+=o*(1/r+1),s+=o*o/r,l=o/r,n>l&&!g.isExtruded()&&r>1&&(n=l,d=c);u=i/s,v>u&&(u=v),t>n*u&&e.getConnection(d).setExtruded(!0)}while(t>n*u);e.getRadius()>0?u=e.getRadius():e.setRadius(u)},r.prototype.find_ic_middle=function(e,t,n,r,o){var i,s,a,u,l;for(i=0,s=-1,a=e,l=!1;!l;)i++>2*o.getNconnection()&&console.log("Infinite loop in 'find_ic_middle'"),null!=n&&o.getConnection(a)==r&&(s=a),l=a==t,++a>=o.getNconnection()&&(a=0);if(-1==s){for(u=1,a=e;(i+1)/2>u;u++)++a>=o.getNconnection()&&(a=0);s=a}return s},r.prototype.construct_extruded_segment=function(e,t){var n,r,o,i,s,a,u,l,c,p,f,h,d,g,y,v,b,m;if(n=e.getAngle(),o=r=t.getAngle(),n>o&&(o+=2*Math.PI),i=(n+o)/2,d=e.getEnd(),g=t.getStart(),y=g-d,0>y&&(y+=this.nbase+1),f=t.getAngle()-e.getAngle(),0>f&&(f+=2*Math.PI),2==y)this.construct_circle_segment(d,g);else{s=this.bases[g].getX()-this.bases[d].getX(),a=this.bases[g].getY()-this.bases[d].getY(),p=Math.sqrt(s*s+a*a),s/=p,a/=p,p>=1.5&&f<=Math.PI/2&&(v=d+1,v>this.nbase&&(v-=this.nbase+1),b=g-1,0>b&&(b+=this.nbase+1),this.bases[v].setX(this.bases[d].getX()+.5*s),this.bases[v].setY(this.bases[d].getY()+.5*a),this.bases[b].setX(this.bases[g].getX()-.5*s),this.bases[b].setY(this.bases[g].getY()-.5*a),d=v,g=b);do m=!1,this.construct_circle_segment(d,g),v=d+1,v>this.nbase&&(v-=this.nbase+1),s=this.bases[v].getX()-this.bases[d].getX(),a=this.bases[v].getY()-this.bases[d].getY(),u=Math.atan2(a,s),0>u&&(u+=2*Math.PI),h=u-n,0>h&&(h+=2*Math.PI),h>Math.PI&&(m=!0),b=g-1,0>b&&(b+=this.nbase+1),s=this.bases[b].getX()-this.bases[g].getX(),a=this.bases[b].getY()-this.bases[g].getY(),l=Math.atan2(a,s),0>l&&(l+=2*Math.PI),h=r-l,0>h&&(h+=2*Math.PI),h>Math.PI&&(m=!0),m&&(c=this.minf2(i,n+.5),this.bases[v].setX(this.bases[d].getX()+Math.cos(c)),this.bases[v].setY(this.bases[d].getY()+Math.sin(c)),d=v,c=this.maxf2(i,o-.5),this.bases[b].setX(this.bases[g].getX()+Math.cos(c)),this.bases[b].setY(this.bases[g].getY()+Math.sin(c)),g=b,y-=2);while(m&&y>1)}},r.prototype.construct_circle_segment=function(e,t){var n,r,o,i,s,a,u,l,c,p,f,h,d,g,y;if(n=this.bases[t].getX()-this.bases[e].getX(),r=this.bases[t].getY()-this.bases[e].getY(),o=Math.sqrt(n*n+r*r),d=t-e,0>d&&(d+=this.nbase+1),o>=d)for(n/=o,r/=o,g=1;d>g;g++)y=e+g,y>this.nbase&&(y-=this.nbase+1),this.bases[y].setX(this.bases[e].getX()+n*g/d),this.bases[y].setY(this.bases[e].getY()+r*g/d);else for(this.find_center_for_arc(d-1,o),n/=o,r/=o,i=this.bases[e].getX()+n*o/2,s=this.bases[e].getY()+r*o/2,a=r,u=-n,l=i+this._h*a,c=s+this._h*u,p=this.bases[e].getX()-l,f=this.bases[e].getY()-c,o=Math.sqrt(p*p+f*f),h=Math.atan2(f,p),g=1;d>g;g++)y=e+g,y>this.nbase&&(y-=this.nbase+1),this.bases[y].setX(l+o*Math.cos(h+g*this.angleinc)),this.bases[y].setY(c+o*Math.sin(h+g*this.angleinc))},r.prototype.find_center_for_arc=function(e,t){var n,r,o,i,s,a,u,l,c;r=(e+1)/Math.PI,o=-r-t/(e+1.000001-t),1>t&&(o=0),c=0;do n=(r+o)/2,i=Math.sqrt(n*n+t*t/4),s=1-.5/(i*i),Math.abs(s)>1&&console.log("Unexpected large magnitude discriminant = "+s+" "+i),a=Math.acos(s),l=Math.acos(n/i),u=a*(e+1)+2*l-2*Math.PI,u>0?o=n:r=n;while(Math.abs(u)>1e-4&&++c<this.MAXITER);c>=this.MAXITER&&(noIterationFailureYet&&(console.log("Iteration failed in find_center_for_arc"),noIterationFailureYet=!1),n=0,a=0),this._h=n,this.angleinc=a},r.prototype.generate_region=function(e){var t,n,r,o,i,s;for(s=e.getRegion(),t=0,e.getStart()==s.getStart1()?(n=s.getStart1(),r=s.getEnd1()):(n=s.getStart2(),r=s.getEnd2()),(this.bases[e.getStart()].getX()>this.ANUM-100||this.bases[e.getEnd()].getX()>this.ANUM-100)&&console.log("Bad region passed to generate_region. Coordinates not defined."),o=n+1;r>=o;o++)t++,this.bases[o].setX(this.bases[e.getStart()].getX()+this.HELIX_FACTOR*t*e.getXrad()),this.bases[o].setY(this.bases[e.getStart()].getY()+this.HELIX_FACTOR*t*e.getYrad()),i=this.bases[o].getMate(),this.bases[i].setX(this.bases[e.getEnd()].getX()+this.HELIX_FACTOR*t*e.getXrad()),this.bases[i].setY(this.bases[e.getEnd()].getY()+this.HELIX_FACTOR*t*e.getYrad())},r.prototype.minf2=function(e,t){return t>e?e:t},r.prototype.maxf2=function(e,t){return e>t?e:t},r.prototype.connected_connection=function(e,t){return e.isExtruded()?!0:e.getEnd()+1==t.getStart()}},function(e,t){"use strict";function n(){this.radius=null,this.loopnumber=null,this.next=null,this.prev=null}Object.defineProperty(t,"__esModule",{value:!0}),t.Radloop=n,n.prototype.getRadius=function(){return this.radius},n.prototype.setRadius=function(e){this.radius=e},n.prototype.getLoopnumber=function(){return this.loopnumber},n.prototype.setLoopnumber=function(e){this.loopnumber=e},n.prototype.getNext=function(){return this.next},n.prototype.setNext=function(e){this.next=e},n.prototype.getPrev=function(){return this.prev},n.prototype.setPrev=function(e){this.prev=e}},function(e,t,n){"use strict";function r(){this.loop=new o.Loop,this.region=new i.Region,this.start=null,this.end=null,this.xrad=null,this.yrad=null,this.angle=null,this.extruded=null,this.broken=null,this._isNull=!1}Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=r;var o=n(11),i=n(12);r.prototype.isNull=function(){return this._isNull},r.prototype.setNull=function(e){this._isNull=e},r.prototype.getLoop=function(){return this.loop},r.prototype.setLoop=function(e){this.loop=e},r.prototype.getRegion=function(){return this.region},r.prototype.setRegion=function(e){
this.region=e},r.prototype.getStart=function(){return this.start},r.prototype.setStart=function(e){this.start=e},r.prototype.getEnd=function(){return this.end},r.prototype.setEnd=function(e){this.end=e},r.prototype.getXrad=function(){return this.xrad},r.prototype.setXrad=function(e){this.xrad=e},r.prototype.getYrad=function(){return this.yrad},r.prototype.setYrad=function(e){this.yrad=e},r.prototype.getAngle=function(){return this.angle},r.prototype.setAngle=function(e){this.angle=e},r.prototype.isExtruded=function(){return this.extruded},r.prototype.setExtruded=function(e){this.extruded=e},r.prototype.isBroken=function(){return this.broken},r.prototype.setBroken=function(e){this.broken=e}},function(e,t,n){"use strict";function r(){this.nconnection=null,this.connections=[],this._connections=[],this.number=null,this.depth=null,this.mark=null,this.x=null,this.y=null,this.radius=null}Object.defineProperty(t,"__esModule",{value:!0}),t.Loop=r;var o=n(10);r.prototype.getNconnection=function(){return this.nconnection},r.prototype.setNconnection=function(e){this.nconnection=e},r.prototype.setConnection=function(e,t){null!=t?this._connections[e]=t:(this._connections[e]||(this._connections[e]=new o.Connection),this._connections[e].setNull(!0))},r.prototype.getConnection=function(e){var t=n(10);this._connections[e]||(this._connections[e]=new t);var r=this._connections[e];return r.isNull()?null:r},r.prototype.addConnection=function(e,t){this._connections.push(t)},r.prototype.getNumber=function(){return this.number},r.prototype.setNumber=function(e){this.number=e},r.prototype.getDepth=function(){return this.depth},r.prototype.setDepth=function(e){this.depth=e},r.prototype.isMark=function(){return this.mark},r.prototype.setMark=function(e){this.mark=e},r.prototype.getX=function(){return this.x},r.prototype.setX=function(e){this.x=e},r.prototype.getY=function(){return this.y},r.prototype.setY=function(e){this.y=e},r.prototype.getRadius=function(){return this.radius},r.prototype.setRadius=function(e){this.radius=e}},function(e,t){"use strict";function n(){this._start1=null,this._end1=null,this._start2=null,this._end2=null}Object.defineProperty(t,"__esModule",{value:!0}),t.Region=n,n.prototype.getStart1=function(){return this._start1},n.prototype.setStart1=function(e){this._start1=e},n.prototype.getEnd1=function(){return this._end1},n.prototype.setEnd1=function(e){this._end1=e},n.prototype.getStart2=function(){return this._start2},n.prototype.setStart2=function(e){this._start2=e},n.prototype.getEnd2=function(){return this._end2},n.prototype.setEnd2=function(e){this._end2=e}},function(e,t,n){"use strict";function r(){this.mate=null,this.x=null,this.y=null,this.extracted=null,this.region=new o.Region}Object.defineProperty(t,"__esModule",{value:!0}),t.Base=r;var o=n(12);r.prototype.getMate=function(){return this.mate},r.prototype.setMate=function(e){this.mate=e},r.prototype.getX=function(){return this.x},r.prototype.setX=function(e){this.x=e},r.prototype.getY=function(){return this.y},r.prototype.setY=function(e){this.y=e},r.prototype.isExtracted=function(){return this.extracted},r.prototype.setExtracted=function(e){this.extracted=e},r.prototype.getRegion=function(){return this.region},r.prototype.setRegion=function(e){this.region=e}},function(e,t,n){var r,o;(function(i,s){!function(i,s){r=s,o="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==o&&(e.exports=o))}(this,function(){"use strict";var e,t=Function.call.bind(Function.apply),n=Function.call.bind(Function.call),r=Array.isArray,o=Object.keys,a=function(e){return function(){return!t(e,this,arguments)}},u=function(e){try{return e(),!1}catch(t){return!0}},l=function(e){try{return e()}catch(t){return!1}},c=a(u),p=function(){return!u(function(){Object.defineProperty({},"x",{get:function(){}})})},f=!!Object.defineProperty&&p(),h="foo"===function(){}.name,d=Function.call.bind(Array.prototype.forEach),g=Function.call.bind(Array.prototype.reduce),y=Function.call.bind(Array.prototype.filter),v=Function.call.bind(Array.prototype.some),b=function(e,t,n,r){!r&&t in e||(f?Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n}):e[t]=n)},m=function(e,t,n){d(o(t),function(r){var o=t[r];b(e,r,o,!!n)})},k=Function.call.bind(Object.prototype.toString),x=function(e){return"function"==typeof e},w={getter:function(e,t,n){if(!f)throw new TypeError("getters require true ES5 support");Object.defineProperty(e,t,{configurable:!0,enumerable:!1,get:n})},proxy:function(e,t,n){if(!f)throw new TypeError("getters require true ES5 support");var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,{configurable:r.configurable,enumerable:r.enumerable,get:function(){return e[t]},set:function(n){e[t]=n}})},redefine:function(e,t,n){if(f){var r=Object.getOwnPropertyDescriptor(e,t);r.value=n,Object.defineProperty(e,t,r)}else e[t]=n},defineByDescriptor:function(e,t,n){f?Object.defineProperty(e,t,n):"value"in n&&(e[t]=n.value)},preserveToString:function(e,t){t&&x(t.toString)&&b(e,"toString",t.toString.bind(t),!0)}},O=Object.create||function(e,t){var n=function(){};n.prototype=e;var r=new n;return"undefined"!=typeof t&&o(t).forEach(function(e){w.defineByDescriptor(r,e,t[e])}),r},S=function(e,t){return Object.setPrototypeOf?l(function(){var n=function r(t){var n=new e(t);return Object.setPrototypeOf(n,r.prototype),n};return Object.setPrototypeOf(n,e),n.prototype=O(e.prototype,{constructor:{value:n}}),t(n)}):!1},T=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof i)return i;throw new Error("unable to locate global object")},E=T(),N=E.isFinite,M=Function.call.bind(String.prototype.indexOf),j=Function.apply.bind(Array.prototype.indexOf),_=Function.call.bind(Array.prototype.concat),P=(Function.call.bind(Array.prototype.sort),Function.call.bind(String.prototype.slice)),C=Function.call.bind(Array.prototype.push),A=Function.apply.bind(Array.prototype.push),I=Function.call.bind(Array.prototype.shift),L=Math.max,R=Math.min,X=Math.floor,F=Math.abs,Y=Math.log,B=Math.sqrt,z=Function.call.bind(Object.prototype.hasOwnProperty),D=function(){},U=E.Symbol||{},q=U.species||"@@species",G=Number.isNaN||function(e){return e!==e},V=Number.isFinite||function(e){return"number"==typeof e&&N(e)},H=function(e){return"[object Arguments]"===k(e)},W=function(e){return null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==k(e)&&"[object Function]"===k(e.callee)},J=H(arguments)?H:W,$={primitive:function(e){return null===e||"function"!=typeof e&&"object"!=typeof e},object:function(e){return null!==e&&"object"==typeof e},string:function(e){return"[object String]"===k(e)},regex:function(e){return"[object RegExp]"===k(e)},symbol:function(e){return"function"==typeof E.Symbol&&"symbol"==typeof e}},Z=function(e,t,n){var r=e[t];b(e,t,n,!0),w.preserveToString(e[t],r)},K="function"==typeof U&&"function"==typeof U["for"]&&$.symbol(U()),Q=$.symbol(U.iterator)?U.iterator:"_es6-shim iterator_";E.Set&&"function"==typeof(new E.Set)["@@iterator"]&&(Q="@@iterator"),E.Reflect||b(E,"Reflect",{},!0);var ee=E.Reflect,te=String,ne={Call:function(e,n){var r=arguments.length>2?arguments[2]:[];if(!ne.IsCallable(e))throw new TypeError(e+" is not a function");return t(e,n,r)},RequireObjectCoercible:function(e,t){if(null==e)throw new TypeError(t||"Cannot call method on "+e);return e},TypeIsObject:function(e){return void 0===e||null===e||e===!0||e===!1?!1:"function"==typeof e||"object"==typeof e},ToObject:function(e,t){return Object(ne.RequireObjectCoercible(e,t))},IsCallable:x,IsConstructor:function(e){return ne.IsCallable(e)},ToInt32:function(e){return ne.ToNumber(e)>>0},ToUint32:function(e){return ne.ToNumber(e)>>>0},ToNumber:function(e){if("[object Symbol]"===k(e))throw new TypeError("Cannot convert a Symbol value to a number");return+e},ToInteger:function(e){var t=ne.ToNumber(e);return G(t)?0:0!==t&&V(t)?(t>0?1:-1)*X(F(t)):t},ToLength:function(e){var t=ne.ToInteger(e);return 0>=t?0:t>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t},SameValue:function(e,t){return e===t?0===e?1/e===1/t:!0:G(e)&&G(t)},SameValueZero:function(e,t){return e===t||G(e)&&G(t)},IsIterable:function(e){return ne.TypeIsObject(e)&&("undefined"!=typeof e[Q]||J(e))},GetIterator:function(t){if(J(t))return new e(t,"value");var n=ne.GetMethod(t,Q);if(!ne.IsCallable(n))throw new TypeError("value is not an iterable");var r=ne.Call(n,t);if(!ne.TypeIsObject(r))throw new TypeError("bad iterator");return r},GetMethod:function(e,t){var n=ne.ToObject(e)[t];if(void 0!==n&&null!==n){if(!ne.IsCallable(n))throw new TypeError("Method not callable: "+t);return n}},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var n=ne.GetMethod(e,"return");if(void 0!==n){var r,o;try{r=ne.Call(n,e)}catch(i){o=i}if(!t){if(o)throw o;if(!ne.TypeIsObject(r))throw new TypeError("Iterator's return method returned a non-object.")}}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!ne.TypeIsObject(t))throw new TypeError("bad iterator");return t},IteratorStep:function(e){var t=ne.IteratorNext(e),n=ne.IteratorComplete(t);return n?!1:t},Construct:function(e,t,n,r){var o="undefined"==typeof n?e:n;if(!r&&ee.construct)return ee.construct(e,t,o);var i=o.prototype;ne.TypeIsObject(i)||(i=Object.prototype);var s=O(i),a=ne.Call(e,s,t);return ne.TypeIsObject(a)?a:s},SpeciesConstructor:function(e,t){var n=e.constructor;if(void 0===n)return t;if(!ne.TypeIsObject(n))throw new TypeError("Bad constructor");var r=n[q];if(void 0===r||null===r)return t;if(!ne.IsConstructor(r))throw new TypeError("Bad @@species");return r},CreateHTML:function(e,t,n,r){var o=ne.ToString(e),i="<"+t;if(""!==n){var s=ne.ToString(r),a=s.replace(/"/g,"&quot;");i+=" "+n+'="'+a+'"'}var u=i+">",l=u+o;return l+"</"+t+">"},IsRegExp:function(e){if(!ne.TypeIsObject(e))return!1;var t=e[U.match];return"undefined"!=typeof t?!!t:$.regex(e)},ToString:function(e){return te(e)}};if(f&&K){var re=function(e){if($.symbol(U[e]))return U[e];var t=U["for"]("Symbol."+e);return Object.defineProperty(U,e,{configurable:!1,enumerable:!1,writable:!1,value:t}),t};if(!$.symbol(U.search)){var oe=re("search"),ie=String.prototype.search;b(RegExp.prototype,oe,function(e){return ne.Call(ie,e,[this])});var se=function(e){var t=ne.RequireObjectCoercible(this);if(null!==e&&"undefined"!=typeof e){var n=ne.GetMethod(e,oe);if("undefined"!=typeof n)return ne.Call(n,e,[t])}return ne.Call(ie,t,[ne.ToString(e)])};Z(String.prototype,"search",se)}if(!$.symbol(U.replace)){var ae=re("replace"),ue=String.prototype.replace;b(RegExp.prototype,ae,function(e,t){return ne.Call(ue,e,[this,t])});var le=function(e,t){var n=ne.RequireObjectCoercible(this);if(null!==e&&"undefined"!=typeof e){var r=ne.GetMethod(e,ae);if("undefined"!=typeof r)return ne.Call(r,e,[n,t])}return ne.Call(ue,n,[ne.ToString(e),t])};Z(String.prototype,"replace",le)}if(!$.symbol(U.split)){var ce=re("split"),pe=String.prototype.split;b(RegExp.prototype,ce,function(e,t){return ne.Call(pe,e,[this,t])});var fe=function(e,t){var n=ne.RequireObjectCoercible(this);if(null!==e&&"undefined"!=typeof e){var r=ne.GetMethod(e,ce);if("undefined"!=typeof r)return ne.Call(r,e,[n,t])}return ne.Call(pe,n,[ne.ToString(e),t])};Z(String.prototype,"split",fe)}var he=$.symbol(U.match),de=he&&function(){var e={};return e[U.match]=function(){return 42},42!=="a".match(e)}();if(!he||de){var ge=re("match"),ye=String.prototype.match;b(RegExp.prototype,ge,function(e){return ne.Call(ye,e,[this])});var ve=function(e){var t=ne.RequireObjectCoercible(this);if(null!==e&&"undefined"!=typeof e){var n=ne.GetMethod(e,ge);if("undefined"!=typeof n)return ne.Call(n,e,[t])}return ne.Call(ye,t,[ne.ToString(e)])};Z(String.prototype,"match",ve)}}var be=function(e,t,n){w.preserveToString(t,e),Object.setPrototypeOf&&Object.setPrototypeOf(e,t),f?d(Object.getOwnPropertyNames(e),function(r){r in D||n[r]||w.proxy(e,r,t)}):d(Object.keys(e),function(r){r in D||n[r]||(t[r]=e[r])}),t.prototype=e.prototype,w.redefine(e.prototype,"constructor",t)},me=function(){return this},ke=function(e){f&&!z(e,q)&&w.getter(e,q,me)},xe=function(e,t){var n=t||function(){return this};b(e,Q,n),!e[Q]&&$.symbol(Q)&&(e[Q]=n)},we=function(e,t,n){f?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:n}):e[t]=n},Oe=function(e,t,n){if(we(e,t,n),!ne.SameValue(e[t],n))throw new TypeError("property is nonconfigurable")},Se=function(e,t,n,r){if(!ne.TypeIsObject(e))throw new TypeError("Constructor requires `new`: "+t.name);var o=t.prototype;ne.TypeIsObject(o)||(o=n);var i=O(o);for(var s in r)if(z(r,s)){var a=r[s];b(i,s,a,!0)}return i};if(String.fromCodePoint&&1!==String.fromCodePoint.length){var Te=String.fromCodePoint;Z(String,"fromCodePoint",function(e){return ne.Call(Te,this,arguments)})}var Ee={fromCodePoint:function(e){for(var t,n=[],r=0,o=arguments.length;o>r;r++){if(t=Number(arguments[r]),!ne.SameValue(t,ne.ToInteger(t))||0>t||t>1114111)throw new RangeError("Invalid code point "+t);65536>t?C(n,String.fromCharCode(t)):(t-=65536,C(n,String.fromCharCode((t>>10)+55296)),C(n,String.fromCharCode(t%1024+56320)))}return n.join("")},raw:function(e){var t=ne.ToObject(e,"bad callSite"),n=ne.ToObject(t.raw,"bad raw value"),r=n.length,o=ne.ToLength(r);if(0>=o)return"";for(var i,s,a,u,l=[],c=0;o>c&&(i=ne.ToString(c),a=ne.ToString(n[i]),C(l,a),!(c+1>=o));)s=c+1<arguments.length?arguments[c+1]:"",u=ne.ToString(s),C(l,u),c+=1;return l.join("")}};String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&Z(String,"raw",Ee.raw),m(String,Ee);var Ne=function _r(e,t){if(1>t)return"";if(t%2)return _r(e,t-1)+e;var n=_r(e,t/2);return n+n},Me=1/0,je={repeat:function(e){var t=ne.ToString(ne.RequireObjectCoercible(this)),n=ne.ToInteger(e);if(0>n||n>=Me)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return Ne(t,n)},startsWith:function(e){var t=ne.ToString(ne.RequireObjectCoercible(this));if(ne.IsRegExp(e))throw new TypeError('Cannot call method "startsWith" with a regex');var n,r=ne.ToString(e);arguments.length>1&&(n=arguments[1]);var o=L(ne.ToInteger(n),0);return P(t,o,o+r.length)===r},endsWith:function(e){var t=ne.ToString(ne.RequireObjectCoercible(this));if(ne.IsRegExp(e))throw new TypeError('Cannot call method "endsWith" with a regex');var n,r=ne.ToString(e),o=t.length;arguments.length>1&&(n=arguments[1]);var i="undefined"==typeof n?o:ne.ToInteger(n),s=R(L(i,0),o);return P(t,s-r.length,s)===r},includes:function(e){if(ne.IsRegExp(e))throw new TypeError('"includes" does not accept a RegExp');var t,n=ne.ToString(e);return arguments.length>1&&(t=arguments[1]),-1!==M(this,n,t)},codePointAt:function(e){var t=ne.ToString(ne.RequireObjectCoercible(this)),n=ne.ToInteger(e),r=t.length;if(n>=0&&r>n){var o=t.charCodeAt(n),i=n+1===r;if(55296>o||o>56319||i)return o;var s=t.charCodeAt(n+1);return 56320>s||s>57343?o:1024*(o-55296)+(s-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",1/0)!==!1&&Z(String.prototype,"includes",je.includes),String.prototype.startsWith&&String.prototype.endsWith){var _e=u(function(){"/a/".startsWith(/a/)}),Pe=l(function(){return"abc".startsWith("a",1/0)===!1});_e&&Pe||(Z(String.prototype,"startsWith",je.startsWith),Z(String.prototype,"endsWith",je.endsWith))}if(K){var Ce=l(function(){var e=/a/;return e[U.match]=!1,"/a/".startsWith(e)});Ce||Z(String.prototype,"startsWith",je.startsWith);var Ae=l(function(){var e=/a/;return e[U.match]=!1,"/a/".endsWith(e)});Ae||Z(String.prototype,"endsWith",je.endsWith);var Ie=l(function(){var e=/a/;return e[U.match]=!1,"/a/".includes(e)});Ie||Z(String.prototype,"includes",je.includes)}m(String.prototype,je);var Le=["	\n\x0B\f\r ","\u2028","\u2029\ufeff"].join(""),Re=new RegExp("(^["+Le+"]+)|(["+Le+"]+$)","g"),Xe=function(){return ne.ToString(ne.RequireObjectCoercible(this)).replace(Re,"")},Fe=["","",""].join(""),Ye=new RegExp("["+Fe+"]","g"),Be=/^[\-+]0x[0-9a-f]+$/i,ze=Fe.trim().length!==Fe.length;b(String.prototype,"trim",Xe,ze);var De=function(e){ne.RequireObjectCoercible(e),this._s=ne.ToString(e),this._i=0};De.prototype.next=function(){var e=this._s,t=this._i;if("undefined"==typeof e||t>=e.length)return this._s=void 0,{value:void 0,done:!0};var n,r,o=e.charCodeAt(t);return 55296>o||o>56319||t+1===e.length?r=1:(n=e.charCodeAt(t+1),r=56320>n||n>57343?1:2),this._i=t+r,{value:e.substr(t,r),done:!1}},xe(De.prototype),xe(String.prototype,function(){return new De(this)});var Ue={from:function(e){var t,r=this;arguments.length>1&&(t=arguments[1]);var o,i;if("undefined"==typeof t)o=!1;else{if(!ne.IsCallable(t))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(i=arguments[2]),o=!0}var s,a,u,l="undefined"!=typeof(J(e)||ne.GetMethod(e,Q));if(l){a=ne.IsConstructor(r)?Object(new r):[];var c,p,f=ne.GetIterator(e);for(u=0;;){if(c=ne.IteratorStep(f),c===!1)break;p=c.value;try{o&&(p="undefined"==typeof i?t(p,u):n(t,i,p,u)),a[u]=p}catch(h){throw ne.IteratorClose(f,!0),h}u+=1}s=u}else{var d=ne.ToObject(e);s=ne.ToLength(d.length),a=ne.IsConstructor(r)?Object(new r(s)):new Array(s);var g;for(u=0;s>u;++u)g=d[u],o&&(g="undefined"==typeof i?t(g,u):n(t,i,g,u)),a[u]=g}return a.length=s,a},of:function(){for(var e=arguments.length,t=this,n=r(t)||!ne.IsCallable(t)?new Array(e):ne.Construct(t,[e]),o=0;e>o;++o)Oe(n,o,arguments[o]);return n.length=e,n}};m(Array,Ue),ke(Array);e=function(e,t){this.i=0,this.array=e,this.kind=t},m(e.prototype,{next:function(){var t=this.i,n=this.array;if(!(this instanceof e))throw new TypeError("Not an ArrayIterator");if("undefined"!=typeof n)for(var r=ne.ToLength(n.length);r>t;t++){var o,i=this.kind;return"key"===i?o=t:"value"===i?o=n[t]:"entry"===i&&(o=[t,n[t]]),this.i=t+1,{value:o,done:!1}}return this.array=void 0,{value:void 0,done:!0}}}),xe(e.prototype);var qe=Array.of===Ue.of||function(){var e=function(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&2===t.length}();qe||Z(Array,"of",Ue.of);var Ge={copyWithin:function(e,t){var n,r=ne.ToObject(this),o=ne.ToLength(r.length),i=ne.ToInteger(e),s=ne.ToInteger(t),a=0>i?L(o+i,0):R(i,o),u=0>s?L(o+s,0):R(s,o);arguments.length>2&&(n=arguments[2]);var l="undefined"==typeof n?o:ne.ToInteger(n),c=0>l?L(o+l,0):R(l,o),p=R(c-u,o-a),f=1;for(a>u&&u+p>a&&(f=-1,u+=p-1,a+=p-1);p>0;)u in r?r[a]=r[u]:delete r[a],u+=f,a+=f,p-=1;return r},fill:function(e){var t;arguments.length>1&&(t=arguments[1]);var n;arguments.length>2&&(n=arguments[2]);var r=ne.ToObject(this),o=ne.ToLength(r.length);t=ne.ToInteger("undefined"==typeof t?0:t),n=ne.ToInteger("undefined"==typeof n?o:n);for(var i=0>t?L(o+t,0):R(t,o),s=0>n?o+n:n,a=i;o>a&&s>a;++a)r[a]=e;return r},find:function(e){var t=ne.ToObject(this),r=ne.ToLength(t.length);if(!ne.IsCallable(e))throw new TypeError("Array#find: predicate must be a function");for(var o,i=arguments.length>1?arguments[1]:null,s=0;r>s;s++)if(o=t[s],i){if(n(e,i,o,s,t))return o}else if(e(o,s,t))return o},findIndex:function(e){var t=ne.ToObject(this),r=ne.ToLength(t.length);if(!ne.IsCallable(e))throw new TypeError("Array#findIndex: predicate must be a function");for(var o=arguments.length>1?arguments[1]:null,i=0;r>i;i++)if(o){if(n(e,o,t[i],i,t))return i}else if(e(t[i],i,t))return i;return-1},keys:function(){return new e(this,"key")},values:function(){return new e(this,"value")},entries:function(){return new e(this,"entry")}};if(Array.prototype.keys&&!ne.IsCallable([1].keys().next)&&delete Array.prototype.keys,Array.prototype.entries&&!ne.IsCallable([1].entries().next)&&delete Array.prototype.entries,Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[Q]&&(m(Array.prototype,{values:Array.prototype[Q]}),$.symbol(U.unscopables)&&(Array.prototype[U.unscopables].values=!0)),h&&Array.prototype.values&&"values"!==Array.prototype.values.name){var Ve=Array.prototype.values;Z(Array.prototype,"values",function(){return ne.Call(Ve,this,arguments)}),b(Array.prototype,Q,Array.prototype.values,!0)}m(Array.prototype,Ge),1/[!0].indexOf(!0,-0)<0&&b(Array.prototype,"indexOf",function(e){var t=j(this,arguments);return 0===t&&0>1/t?0:t},!0),xe(Array.prototype,function(){return this.values()}),Object.getPrototypeOf&&xe(Object.getPrototypeOf([].values()));var He=function(){return l(function(){return 0===Array.from({length:-1}).length})}(),We=function(){var e=Array.from([0].entries());return 1===e.length&&r(e[0])&&0===e[0][0]&&0===e[0][1]}();He&&We||Z(Array,"from",Ue.from);var Je=function(){return l(function(){return Array.from([0],void 0)})}();if(!Je){var $e=Array.from;Z(Array,"from",function(e){return arguments.length>1&&"undefined"!=typeof arguments[1]?ne.Call($e,this,arguments):n($e,this,e)})}var Ze=-(Math.pow(2,32)-1),Ke=function(e,t){var r={length:Ze};return r[t?(r.length>>>0)-1:0]=!0,l(function(){return n(e,r,function(){throw new RangeError("should not reach here")},[]),!0})};if(!Ke(Array.prototype.forEach)){var Qe=Array.prototype.forEach;Z(Array.prototype,"forEach",function(e){return ne.Call(Qe,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.map)){var et=Array.prototype.map;Z(Array.prototype,"map",function(e){return ne.Call(et,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.filter)){var tt=Array.prototype.filter;Z(Array.prototype,"filter",function(e){return ne.Call(tt,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.some)){var nt=Array.prototype.some;Z(Array.prototype,"some",function(e){return ne.Call(nt,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.every)){var rt=Array.prototype.every;Z(Array.prototype,"every",function(e){return ne.Call(rt,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.reduce)){var ot=Array.prototype.reduce;Z(Array.prototype,"reduce",function(e){return ne.Call(ot,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.reduceRight,!0)){var it=Array.prototype.reduceRight;Z(Array.prototype,"reduceRight",function(e){return ne.Call(it,this.length>=0?this:[],arguments)},!0)}var st=8!==Number("0o10"),at=2!==Number("0b10"),ut=v(Fe,function(e){return 0===Number(e+0+e)});if(st||at||ut){var lt=Number,ct=/^0b[01]+$/i,pt=/^0o[0-7]+$/i,ft=ct.test.bind(ct),ht=pt.test.bind(pt),dt=function(e){var t;if("function"==typeof e.valueOf&&(t=e.valueOf(),$.primitive(t)))return t;if("function"==typeof e.toString&&(t=e.toString(),$.primitive(t)))return t;throw new TypeError("No default value")},gt=Ye.test.bind(Ye),yt=Be.test.bind(Be),vt=function(){var e=function(t){var n;n=arguments.length>0?$.primitive(t)?t:dt(t,"number"):0,"string"==typeof n&&(n=ne.Call(Xe,n),ft(n)?n=parseInt(P(n,2),2):ht(n)?n=parseInt(P(n,2),8):(gt(n)||yt(n))&&(n=NaN));var r=this,o=l(function(){return lt.prototype.valueOf.call(r),!0});return r instanceof e&&!o?new lt(n):lt(n)};return e}();be(lt,vt,{}),m(vt,{NaN:lt.NaN,MAX_VALUE:lt.MAX_VALUE,MIN_VALUE:lt.MIN_VALUE,NEGATIVE_INFINITY:lt.NEGATIVE_INFINITY,POSITIVE_INFINITY:lt.POSITIVE_INFINITY}),Number=vt,w.redefine(E,"Number",vt)}var bt=Math.pow(2,53)-1;m(Number,{MAX_SAFE_INTEGER:bt,MIN_SAFE_INTEGER:-bt,EPSILON:2.220446049250313e-16,parseInt:E.parseInt,parseFloat:E.parseFloat,isFinite:V,isInteger:function(e){return V(e)&&ne.ToInteger(e)===e},isSafeInteger:function(e){return Number.isInteger(e)&&F(e)<=Number.MAX_SAFE_INTEGER},isNaN:G}),b(Number,"parseInt",E.parseInt,Number.parseInt!==E.parseInt),[,1].find(function(e,t){return 0===t})||Z(Array.prototype,"find",Ge.find),0!==[,1].findIndex(function(e,t){return 0===t})&&Z(Array.prototype,"findIndex",Ge.findIndex);var mt=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),kt=function(e,t){f&&mt(e,t)&&Object.defineProperty(e,t,{enumerable:!1})},xt=function(){for(var e=Number(this),t=arguments.length,n=t-e,r=new Array(0>n?0:n),o=e;t>o;++o)r[o-e]=arguments[o];return r},wt=function(e){return function(t,n){return t[n]=e[n],t}},Ot=function(e,t){var n,r=o(Object(t));return ne.IsCallable(Object.getOwnPropertySymbols)&&(n=y(Object.getOwnPropertySymbols(Object(t)),mt(t))),g(_(r,n||[]),wt(t),e)},St={assign:function(e,t){var n=ne.ToObject(e,"Cannot convert undefined or null to object");return g(ne.Call(xt,1,arguments),Ot,n)},is:function(e,t){return ne.SameValue(e,t)}},Tt=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}}();if(Tt&&Z(Object,"assign",St.assign),m(Object,St),f){var Et={setPrototypeOf:function(e,t){var r,o=function(e,t){if(!ne.TypeIsObject(e))throw new TypeError("cannot set prototype on a non-object");if(null!==t&&!ne.TypeIsObject(t))throw new TypeError("can only set prototype to an object or null"+t)},i=function(e,t){return o(e,t),n(r,e,t),e};try{r=e.getOwnPropertyDescriptor(e.prototype,t).set,n(r,{},null)}catch(s){if(e.prototype!=={}[t])return;r=function(e){this[t]=e},i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};m(Object,Et)}Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&!function(){var e=Object.create(null),t=Object.getPrototypeOf,n=Object.setPrototypeOf;Object.getPrototypeOf=function(n){var r=t(n);return r===e?null:r},Object.setPrototypeOf=function(t,r){var o=null===r?e:r;return n(t,o)},Object.setPrototypeOf.polyfill=!1}();var Nt=!u(function(){Object.keys("foo")});if(!Nt){var Mt=Object.keys;Z(Object,"keys",function(e){return Mt(ne.ToObject(e))}),o=Object.keys}var jt=u(function(){Object.keys(/a/g)});if(jt){var _t=Object.keys;Z(Object,"keys",function(e){if($.regex(e)){var t=[];for(var n in e)z(e,n)&&C(t,n);return t}return _t(e)}),o=Object.keys}if(Object.getOwnPropertyNames){var Pt=!u(function(){Object.getOwnPropertyNames("foo")});if(!Pt){var Ct="object"==typeof window?Object.getOwnPropertyNames(window):[],At=Object.getOwnPropertyNames;Z(Object,"getOwnPropertyNames",function(e){var t=ne.ToObject(e);if("[object Window]"===k(t))try{return At(t)}catch(n){return _([],Ct)}return At(t)})}}if(Object.getOwnPropertyDescriptor){var It=!u(function(){Object.getOwnPropertyDescriptor("foo","bar")});if(!It){var Lt=Object.getOwnPropertyDescriptor;Z(Object,"getOwnPropertyDescriptor",function(e,t){return Lt(ne.ToObject(e),t)})}}if(Object.seal){var Rt=!u(function(){Object.seal("foo")});if(!Rt){var Xt=Object.seal;Z(Object,"seal",function(e){return $.object(e)?Xt(e):e})}}if(Object.isSealed){var Ft=!u(function(){Object.isSealed("foo")});if(!Ft){var Yt=Object.isSealed;Z(Object,"isSealed",function(e){return $.object(e)?Yt(e):!0})}}if(Object.freeze){var Bt=!u(function(){Object.freeze("foo")});if(!Bt){var zt=Object.freeze;Z(Object,"freeze",function(e){return $.object(e)?zt(e):e})}}if(Object.isFrozen){var Dt=!u(function(){Object.isFrozen("foo")});if(!Dt){var Ut=Object.isFrozen;Z(Object,"isFrozen",function(e){return $.object(e)?Ut(e):!0})}}if(Object.preventExtensions){var qt=!u(function(){Object.preventExtensions("foo")});if(!qt){var Gt=Object.preventExtensions;Z(Object,"preventExtensions",function(e){return $.object(e)?Gt(e):e})}}if(Object.isExtensible){var Vt=!u(function(){Object.isExtensible("foo")});if(!Vt){var Ht=Object.isExtensible;Z(Object,"isExtensible",function(e){return $.object(e)?Ht(e):!1})}}if(Object.getPrototypeOf){var Wt=!u(function(){Object.getPrototypeOf("foo")});if(!Wt){var Jt=Object.getPrototypeOf;Z(Object,"getPrototypeOf",function(e){return Jt(ne.ToObject(e))})}}var $t=f&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&ne.IsCallable(e.get)}();if(f&&!$t){var Zt=function(){if(!ne.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");var e="";return this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e};w.getter(RegExp.prototype,"flags",Zt)}var Kt=f&&l(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),Qt=K&&f&&function(){var e=/./;return e[U.match]=!1,RegExp(e)===e}(),en=l(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),tn=en&&l(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!en||!tn){var nn=RegExp.prototype.toString;b(RegExp.prototype,"toString",function(){var e=ne.RequireObjectCoercible(this);if($.regex(e))return n(nn,e);var t=te(e.source),r=te(e.flags);return"/"+t+"/"+r},!0),w.preserveToString(RegExp.prototype.toString,nn)}if(f&&(!Kt||Qt)){var rn=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,on=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},sn=function(){return this.source},an=ne.IsCallable(on.get)?on.get:sn,un=RegExp,ln=function(){return function e(t,n){var r=ne.IsRegExp(t),o=this instanceof e;if(!o&&r&&"undefined"==typeof n&&t.constructor===e)return t;var i=t,s=n;return $.regex(t)?(i=ne.Call(an,t),s="undefined"==typeof n?ne.Call(rn,t):n,new e(i,s)):(r&&(i=t.source,s="undefined"==typeof n?t.flags:n),new un(t,n))}}();be(un,ln,{$input:!0}),RegExp=ln,w.redefine(E,"RegExp",ln)}if(f){var cn={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};d(o(cn),function(e){e in RegExp&&!(cn[e]in RegExp)&&w.getter(RegExp,cn[e],function(){return RegExp[e]})})}ke(RegExp);var pn=1/Number.EPSILON,fn=function(e){return e+pn-pn},hn=Math.pow(2,-23),dn=Math.pow(2,127)*(2-hn),gn=Math.pow(2,-126),yn=Number.prototype.clz;delete Number.prototype.clz;var vn={acosh:function(e){var t=Number(e);return Number.isNaN(t)||1>e?NaN:1===t?0:t===1/0?t:Y(t/Math.E+B(t+1)*B(t-1)/Math.E)+1},asinh:function(e){var t=Number(e);return 0!==t&&N(t)?0>t?-Math.asinh(-t):Y(t+B(t*t+1)):t},atanh:function(e){var t=Number(e);return Number.isNaN(t)||-1>t||t>1?NaN:-1===t?-(1/0):1===t?1/0:0===t?t:.5*Y((1+t)/(1-t))},cbrt:function(e){var t=Number(e);if(0===t)return t;var n,r=0>t;return r&&(t=-t),t===1/0?n=1/0:(n=Math.exp(Y(t)/3),n=(t/(n*n)+2*n)/3),r?-n:n},clz32:function(e){var t=Number(e),n=ne.ToUint32(t);return 0===n?32:yn?ne.Call(yn,n):31-X(Y(n+.5)*Math.LOG2E)},cosh:function(e){var t=Number(e);return 0===t?1:Number.isNaN(t)?NaN:N(t)?(0>t&&(t=-t),t>21?Math.exp(t)/2:(Math.exp(t)+Math.exp(-t))/2):1/0},expm1:function(e){var t=Number(e);if(t===-(1/0))return-1;if(!N(t)||0===t)return t;if(F(t)>.5)return Math.exp(t)-1;for(var n=t,r=0,o=1;r+n!==r;)r+=n,o+=1,n*=t/o;return r},hypot:function(e,t){for(var n=0,r=0,o=0;o<arguments.length;++o){var i=F(Number(arguments[o]));i>r?(n*=r/i*(r/i),n+=1,r=i):n+=i>0?i/r*(i/r):i}return r===1/0?1/0:r*B(n)},log2:function(e){return Y(e)*Math.LOG2E},log10:function(e){return Y(e)*Math.LOG10E},log1p:function(e){var t=Number(e);return-1>t||Number.isNaN(t)?NaN:0===t||t===1/0?t:-1===t?-(1/0):1+t-1===0?t:t*(Y(1+t)/(1+t-1))},sign:function(e){var t=Number(e);return 0===t?t:Number.isNaN(t)?t:0>t?-1:1},sinh:function(e){var t=Number(e);return N(t)&&0!==t?F(t)<1?(Math.expm1(t)-Math.expm1(-t))/2:(Math.exp(t-1)-Math.exp(-t-1))*Math.E/2:t},tanh:function(e){var t=Number(e);if(Number.isNaN(t)||0===t)return t;if(t>=20)return 1;if(-20>=t)return-1;var n=Math.expm1(t),r=Math.expm1(-t);return n===1/0?1:r===1/0?-1:(n-r)/(Math.exp(t)+Math.exp(-t))},trunc:function(e){var t=Number(e);return 0>t?-X(-t):X(t)},imul:function(e,t){var n=ne.ToUint32(e),r=ne.ToUint32(t),o=n>>>16&65535,i=65535&n,s=r>>>16&65535,a=65535&r;return i*a+(o*a+i*s<<16>>>0)|0},fround:function(e){var t=Number(e);if(0===t||t===1/0||t===-(1/0)||G(t))return t;var n=Math.sign(t),r=F(t);if(gn>r)return n*fn(r/gn/hn)*gn*hn;var o=(1+hn/Number.EPSILON)*r,i=o-(o-r);return i>dn||G(i)?n*(1/0):n*i}};m(Math,vn),b(Math,"log1p",vn.log1p,-1e-17!==Math.log1p(-1e-17)),b(Math,"asinh",vn.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7)),b(Math,"tanh",vn.tanh,-2e-17!==Math.tanh(-2e-17)),b(Math,"acosh",vn.acosh,Math.acosh(Number.MAX_VALUE)===1/0),b(Math,"cbrt",vn.cbrt,Math.abs(1-Math.cbrt(1e-300)/1e-100)/Number.EPSILON>8),b(Math,"sinh",vn.sinh,-2e-17!==Math.sinh(-2e-17));var bn=Math.expm1(10);b(Math,"expm1",vn.expm1,bn>22025.465794806718||22025.465794806718>bn);var mn=Math.round,kn=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(-.5+Number.EPSILON/3.99),xn=pn+1,wn=2*pn-1,On=[xn,wn].every(function(e){
return Math.round(e)===e});b(Math,"round",function(e){var t=X(e),n=-1===t?-0:t+1;return.5>e-t?t:n},!kn||!On),w.preserveToString(Math.round,mn);var Sn=Math.imul;-5!==Math.imul(4294967295,5)&&(Math.imul=vn.imul,w.preserveToString(Math.imul,Sn)),2!==Math.imul.length&&Z(Math,"imul",function(e,t){return ne.Call(Sn,Math,arguments)});var Tn=function(){var e=E.setTimeout;if("function"==typeof e||"object"==typeof e){ne.IsPromise=function(e){return ne.TypeIsObject(e)?"undefined"!=typeof e._promise:!1};var t,r=function(e){if(!ne.IsConstructor(e))throw new TypeError("Bad promise constructor");var t=this,n=function(e,n){if(void 0!==t.resolve||void 0!==t.reject)throw new TypeError("Bad Promise implementation!");t.resolve=e,t.reject=n};if(t.resolve=void 0,t.reject=void 0,t.promise=new e(n),!ne.IsCallable(t.resolve)||!ne.IsCallable(t.reject))throw new TypeError("Bad promise constructor")};"undefined"!=typeof window&&ne.IsCallable(window.postMessage)&&(t=function(){var e=[],t="zero-timeout-message",n=function(n){C(e,n),window.postMessage(t,"*")},r=function(n){if(n.source===window&&n.data===t){if(n.stopPropagation(),0===e.length)return;var r=I(e);r()}};return window.addEventListener("message",r,!0),n});var o,i,a=function(){var e=E.Promise,t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}},u=ne.IsCallable(E.setImmediate)?E.setImmediate:"object"==typeof s&&s.nextTick?s.nextTick:a()||(ne.IsCallable(t)?t():function(t){e(t,0)}),l=function(e){return e},c=function(e){throw e},p=0,f=1,h=2,d=0,g=1,y=2,v={},b=function(e,t,n){u(function(){k(e,t,n)})},k=function(e,t,n){var r,o;if(t===v)return e(n);try{r=e(n),o=t.resolve}catch(i){r=i,o=t.reject}o(r)},x=function(e,t){var n=e._promise,r=n.reactionLength;if(r>0&&(b(n.fulfillReactionHandler0,n.reactionCapability0,t),n.fulfillReactionHandler0=void 0,n.rejectReactions0=void 0,n.reactionCapability0=void 0,r>1))for(var o=1,i=0;r>o;o++,i+=3)b(n[i+d],n[i+y],t),e[i+d]=void 0,e[i+g]=void 0,e[i+y]=void 0;n.result=t,n.state=f,n.reactionLength=0},w=function(e,t){var n=e._promise,r=n.reactionLength;if(r>0&&(b(n.rejectReactionHandler0,n.reactionCapability0,t),n.fulfillReactionHandler0=void 0,n.rejectReactions0=void 0,n.reactionCapability0=void 0,r>1))for(var o=1,i=0;r>o;o++,i+=3)b(n[i+g],n[i+y],t),e[i+d]=void 0,e[i+g]=void 0,e[i+y]=void 0;n.result=t,n.state=h,n.reactionLength=0},O=function(e){var t=!1,n=function(n){var r;if(!t){if(t=!0,n===e)return w(e,new TypeError("Self resolution"));if(!ne.TypeIsObject(n))return x(e,n);try{r=n.then}catch(o){return w(e,o)}return ne.IsCallable(r)?void u(function(){T(e,n,r)}):x(e,n)}},r=function(n){return t?void 0:(t=!0,w(e,n))};return{resolve:n,reject:r}},S=function(e,t,r,o){e===i?n(e,t,r,o,v):n(e,t,r,o)},T=function(e,t,n){var r=O(e),o=r.resolve,i=r.reject;try{S(n,t,o,i)}catch(s){i(s)}},N=function(){var e=function(t){if(!(this instanceof e))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");if(!ne.IsCallable(t))throw new TypeError("not a valid resolver");var n=Se(this,e,o,{_promise:{result:void 0,state:p,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),r=O(n),i=r.reject;try{t(r.resolve,i)}catch(s){i(s)}return n};return e}();o=N.prototype;var M=function(e,t,n,r){var o=!1;return function(i){if(!o&&(o=!0,t[e]=i,0===--r.count)){var s=n.resolve;s(t)}}},j=function(e,t,n){for(var r,o,i=e.iterator,s=[],a={count:1},u=0;;){try{if(r=ne.IteratorStep(i),r===!1){e.done=!0;break}o=r.value}catch(l){throw e.done=!0,l}s[u]=void 0;var c=t.resolve(o),p=M(u,s,n,a);a.count+=1,S(c.then,c,p,n.reject),u+=1}if(0===--a.count){var f=n.resolve;f(s)}return n.promise},_=function(e,t,n){for(var r,o,i,s=e.iterator;;){try{if(r=ne.IteratorStep(s),r===!1){e.done=!0;break}o=r.value}catch(a){throw e.done=!0,a}i=t.resolve(o),S(i.then,i,n.resolve,n.reject)}return n.promise};return m(N,{all:function(e){var t=this;if(!ne.TypeIsObject(t))throw new TypeError("Promise is not object");var n,o,i=new r(t);try{return n=ne.GetIterator(e),o={iterator:n,done:!1},j(o,t,i)}catch(s){var a=s;if(o&&!o.done)try{ne.IteratorClose(n,!0)}catch(u){a=u}var l=i.reject;return l(a),i.promise}},race:function(e){var t=this;if(!ne.TypeIsObject(t))throw new TypeError("Promise is not object");var n,o,i=new r(t);try{return n=ne.GetIterator(e),o={iterator:n,done:!1},_(o,t,i)}catch(s){var a=s;if(o&&!o.done)try{ne.IteratorClose(n,!0)}catch(u){a=u}var l=i.reject;return l(a),i.promise}},reject:function(e){var t=this;if(!ne.TypeIsObject(t))throw new TypeError("Bad promise constructor");var n=new r(t),o=n.reject;return o(e),n.promise},resolve:function(e){var t=this;if(!ne.TypeIsObject(t))throw new TypeError("Bad promise constructor");if(ne.IsPromise(e)){var n=e.constructor;if(n===t)return e}var o=new r(t),i=o.resolve;return i(e),o.promise}}),m(o,{"catch":function(e){return this.then(null,e)},then:function(e,t){var n=this;if(!ne.IsPromise(n))throw new TypeError("not a promise");var o,i=ne.SpeciesConstructor(n,N),s=arguments.length>2&&arguments[2]===v;o=s&&i===N?v:new r(i);var a,u=ne.IsCallable(e)?e:l,m=ne.IsCallable(t)?t:c,k=n._promise;if(k.state===p){if(0===k.reactionLength)k.fulfillReactionHandler0=u,k.rejectReactionHandler0=m,k.reactionCapability0=o;else{var x=3*(k.reactionLength-1);k[x+d]=u,k[x+g]=m,k[x+y]=o}k.reactionLength+=1}else if(k.state===f)a=k.result,b(u,o,a);else{if(k.state!==h)throw new TypeError("unexpected Promise state");a=k.result,b(m,o,a)}return o.promise}}),v=new r(N),i=o.then,N}}();if(E.Promise&&(delete E.Promise.accept,delete E.Promise.defer,delete E.Promise.prototype.chain),"function"==typeof Tn){m(E,{Promise:Tn});var En=S(E.Promise,function(e){return e.resolve(42).then(function(){})instanceof e}),Nn=!u(function(){E.Promise.reject(42).then(null,5).then(null,D)}),Mn=u(function(){E.Promise.call(3,D)}),jn=function(e){var t=e.resolve(5);t.constructor={};var n=e.resolve(t);try{n.then(null,D).then(null,D)}catch(r){return!0}return t===n}(E.Promise),_n=f&&function(){var e=0,t=Object.defineProperty({},"then",{get:function(){e+=1}});return Promise.resolve(t),1===e}(),Pn=function Pr(e){var t=new Promise(e);e(3,function(){}),this.then=t.then,this.constructor=Pr};Pn.prototype=Promise.prototype,Pn.all=Promise.all;var Cn=l(function(){return!!Pn.all([1,2])});if(En&&Nn&&Mn&&!jn&&_n&&!Cn||(Promise=Tn,Z(E,"Promise",Tn)),1!==Promise.all.length){var An=Promise.all;Z(Promise,"all",function(e){return ne.Call(An,this,arguments)})}if(1!==Promise.race.length){var In=Promise.race;Z(Promise,"race",function(e){return ne.Call(In,this,arguments)})}if(1!==Promise.resolve.length){var Ln=Promise.resolve;Z(Promise,"resolve",function(e){return ne.Call(Ln,this,arguments)})}if(1!==Promise.reject.length){var Rn=Promise.reject;Z(Promise,"reject",function(e){return ne.Call(Rn,this,arguments)})}kt(Promise,"all"),kt(Promise,"race"),kt(Promise,"resolve"),kt(Promise,"reject"),ke(Promise)}var Xn=function(e){var t=o(g(e,function(e,t){return e[t]=!0,e},{}));return e.join(":")===t.join(":")},Fn=Xn(["z","a","bb"]),Yn=Xn(["z",1,"a","3",2]);if(f){var Bn=function(e){return Fn?"undefined"==typeof e||null===e?"^"+ne.ToString(e):"string"==typeof e?"$"+e:"number"==typeof e?Yn?e:"n"+e:"boolean"==typeof e?"b"+e:null:null},zn=function(){return Object.create?Object.create(null):{}},Dn=function(e,t,o){if(r(o)||$.string(o))d(o,function(e){if(!ne.TypeIsObject(e))throw new TypeError("Iterator value "+e+" is not an entry object");t.set(e[0],e[1])});else if(o instanceof e)n(e.prototype.forEach,o,function(e,n){t.set(n,e)});else{var i,s;if(null!==o&&"undefined"!=typeof o){if(s=t.set,!ne.IsCallable(s))throw new TypeError("bad map");i=ne.GetIterator(o)}if("undefined"!=typeof i)for(;;){var a=ne.IteratorStep(i);if(a===!1)break;var u=a.value;try{if(!ne.TypeIsObject(u))throw new TypeError("Iterator value "+u+" is not an entry object");n(s,t,u[0],u[1])}catch(l){throw ne.IteratorClose(i,!0),l}}}},Un=function(e,t,o){if(r(o)||$.string(o))d(o,function(e){t.add(e)});else if(o instanceof e)n(e.prototype.forEach,o,function(e){t.add(e)});else{var i,s;if(null!==o&&"undefined"!=typeof o){if(s=t.add,!ne.IsCallable(s))throw new TypeError("bad set");i=ne.GetIterator(o)}if("undefined"!=typeof i)for(;;){var a=ne.IteratorStep(i);if(a===!1)break;var u=a.value;try{n(s,t,u)}catch(l){throw ne.IteratorClose(i,!0),l}}}},qn={Map:function(){var e={},t=function(e,t){this.key=e,this.value=t,this.next=null,this.prev=null};t.prototype.isRemoved=function(){return this.key===e};var r=function(e){return!!e._es6map},o=function(e,t){if(!ne.TypeIsObject(e)||!r(e))throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+ne.ToString(e))},i=function(e,t){o(e,"[[MapIterator]]"),this.head=e._head,this.i=this.head,this.kind=t};i.prototype={next:function(){var e,t=this.i,n=this.kind,r=this.head;if("undefined"==typeof this.i)return{value:void 0,done:!0};for(;t.isRemoved()&&t!==r;)t=t.prev;for(;t.next!==r;)if(t=t.next,!t.isRemoved())return e="key"===n?t.key:"value"===n?t.value:[t.key,t.value],this.i=t,{value:e,done:!1};return this.i=void 0,{value:void 0,done:!0}}},xe(i.prototype);var s,a=function u(){if(!(this instanceof u))throw new TypeError('Constructor Map requires "new"');if(this&&this._es6map)throw new TypeError("Bad construction");var e=Se(this,u,s,{_es6map:!0,_head:null,_storage:zn(),_size:0}),n=new t(null,null);return n.next=n.prev=n,e._head=n,arguments.length>0&&Dn(u,e,arguments[0]),e};return s=a.prototype,w.getter(s,"size",function(){if("undefined"==typeof this._size)throw new TypeError("size method called on incompatible Map");return this._size}),m(s,{get:function(e){o(this,"get");var t=Bn(e);if(null!==t){var n=this._storage[t];return n?n.value:void 0}for(var r=this._head,i=r;(i=i.next)!==r;)if(ne.SameValueZero(i.key,e))return i.value},has:function(e){o(this,"has");var t=Bn(e);if(null!==t)return"undefined"!=typeof this._storage[t];for(var n=this._head,r=n;(r=r.next)!==n;)if(ne.SameValueZero(r.key,e))return!0;return!1},set:function(e,n){o(this,"set");var r,i=this._head,s=i,a=Bn(e);if(null!==a){if("undefined"!=typeof this._storage[a])return this._storage[a].value=n,this;r=this._storage[a]=new t(e,n),s=i.prev}for(;(s=s.next)!==i;)if(ne.SameValueZero(s.key,e))return s.value=n,this;return r=r||new t(e,n),ne.SameValue(-0,e)&&(r.key=0),r.next=this._head,r.prev=this._head.prev,r.prev.next=r,r.next.prev=r,this._size+=1,this},"delete":function(t){o(this,"delete");var n=this._head,r=n,i=Bn(t);if(null!==i){if("undefined"==typeof this._storage[i])return!1;r=this._storage[i].prev,delete this._storage[i]}for(;(r=r.next)!==n;)if(ne.SameValueZero(r.key,t))return r.key=r.value=e,r.prev.next=r.next,r.next.prev=r.prev,this._size-=1,!0;return!1},clear:function(){o(this,"clear"),this._size=0,this._storage=zn();for(var t=this._head,n=t,r=n.next;(n=r)!==t;)n.key=n.value=e,r=n.next,n.next=n.prev=t;t.next=t.prev=t},keys:function(){return o(this,"keys"),new i(this,"key")},values:function(){return o(this,"values"),new i(this,"value")},entries:function(){return o(this,"entries"),new i(this,"key+value")},forEach:function(e){o(this,"forEach");for(var t=arguments.length>1?arguments[1]:null,r=this.entries(),i=r.next();!i.done;i=r.next())t?n(e,t,i.value[1],i.value[0],this):e(i.value[1],i.value[0],this)}}),xe(s,s.entries),a}(),Set:function(){var e,t=function(e){return e._es6set&&"undefined"!=typeof e._storage},r=function(e,n){if(!ne.TypeIsObject(e)||!t(e))throw new TypeError("Set.prototype."+n+" called on incompatible receiver "+ne.ToString(e))},i=function u(){if(!(this instanceof u))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var t=Se(this,u,e,{_es6set:!0,"[[SetData]]":null,_storage:zn()});if(!t._es6set)throw new TypeError("bad set");return arguments.length>0&&Un(u,t,arguments[0]),t};e=i.prototype;var s=function(e){var t=e;if("^null"===t)return null;if("^undefined"!==t){var n=t.charAt(0);return"$"===n?P(t,1):"n"===n?+P(t,1):"b"===n?"btrue"===t:+t}},a=function(e){if(!e["[[SetData]]"]){var t=e["[[SetData]]"]=new qn.Map;d(o(e._storage),function(e){var n=s(e);t.set(n,n)}),e["[[SetData]]"]=t}e._storage=null};return w.getter(i.prototype,"size",function(){return r(this,"size"),this._storage?o(this._storage).length:(a(this),this["[[SetData]]"].size)}),m(i.prototype,{has:function(e){r(this,"has");var t;return this._storage&&null!==(t=Bn(e))?!!this._storage[t]:(a(this),this["[[SetData]]"].has(e))},add:function(e){r(this,"add");var t;return this._storage&&null!==(t=Bn(e))?(this._storage[t]=!0,this):(a(this),this["[[SetData]]"].set(e,e),this)},"delete":function(e){r(this,"delete");var t;if(this._storage&&null!==(t=Bn(e))){var n=z(this._storage,t);return delete this._storage[t]&&n}return a(this),this["[[SetData]]"]["delete"](e)},clear:function(){r(this,"clear"),this._storage&&(this._storage=zn()),this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function(){return r(this,"values"),a(this),this["[[SetData]]"].values()},entries:function(){return r(this,"entries"),a(this),this["[[SetData]]"].entries()},forEach:function(e){r(this,"forEach");var t=arguments.length>1?arguments[1]:null,o=this;a(o),this["[[SetData]]"].forEach(function(r,i){t?n(e,t,i,i,o):e(i,i,o)})}}),b(i.prototype,"keys",i.prototype.values,!0),xe(i.prototype,i.prototype.values),i}()};if(E.Map||E.Set){var Gn=l(function(){return 2===new Map([[1,2]]).get(1)});if(!Gn){var Vn=E.Map;E.Map=function Cr(){if(!(this instanceof Cr))throw new TypeError('Constructor Map requires "new"');var e=new Vn;return arguments.length>0&&Dn(Cr,e,arguments[0]),delete e.constructor,Object.setPrototypeOf(e,E.Map.prototype),e},E.Map.prototype=O(Vn.prototype),b(E.Map.prototype,"constructor",E.Map,!0),w.preserveToString(E.Map,Vn)}var Hn=new Map,Wn=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);return e.set(-0,e),e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}(),Jn=Hn.set(1,2)===Hn;if(!Wn||!Jn){var $n=Map.prototype.set;Z(Map.prototype,"set",function(e,t){return n($n,this,0===e?0:e,t),this})}if(!Wn){var Zn=Map.prototype.get,Kn=Map.prototype.has;m(Map.prototype,{get:function(e){return n(Zn,this,0===e?0:e)},has:function(e){return n(Kn,this,0===e?0:e)}},!0),w.preserveToString(Map.prototype.get,Zn),w.preserveToString(Map.prototype.has,Kn)}var Qn=new Set,er=function(e){return e["delete"](0),e.add(-0),!e.has(0)}(Qn),tr=Qn.add(1)===Qn;if(!er||!tr){var nr=Set.prototype.add;Set.prototype.add=function(e){return n(nr,this,0===e?0:e),this},w.preserveToString(Set.prototype.add,nr)}if(!er){var rr=Set.prototype.has;Set.prototype.has=function(e){return n(rr,this,0===e?0:e)},w.preserveToString(Set.prototype.has,rr);var or=Set.prototype["delete"];Set.prototype["delete"]=function(e){return n(or,this,0===e?0:e)},w.preserveToString(Set.prototype["delete"],or)}var ir=S(E.Map,function(e){var t=new e([]);return t.set(42,42),t instanceof e}),sr=Object.setPrototypeOf&&!ir,ar=function(){try{return!(E.Map()instanceof E.Map)}catch(e){return e instanceof TypeError}}();if(0!==E.Map.length||sr||!ar){var ur=E.Map;E.Map=function Ar(){if(!(this instanceof Ar))throw new TypeError('Constructor Map requires "new"');var e=new ur;return arguments.length>0&&Dn(Ar,e,arguments[0]),delete e.constructor,Object.setPrototypeOf(e,Ar.prototype),e},E.Map.prototype=ur.prototype,b(E.Map.prototype,"constructor",E.Map,!0),w.preserveToString(E.Map,ur)}var lr=S(E.Set,function(e){var t=new e([]);return t.add(42,42),t instanceof e}),cr=Object.setPrototypeOf&&!lr,pr=function(){try{return!(E.Set()instanceof E.Set)}catch(e){return e instanceof TypeError}}();if(0!==E.Set.length||cr||!pr){var fr=E.Set;E.Set=function Ir(){if(!(this instanceof Ir))throw new TypeError('Constructor Set requires "new"');var e=new fr;return arguments.length>0&&Un(Ir,e,arguments[0]),delete e.constructor,Object.setPrototypeOf(e,Ir.prototype),e},E.Set.prototype=fr.prototype,b(E.Set.prototype,"constructor",E.Set,!0),w.preserveToString(E.Set,fr)}var hr=!l(function(){return(new Map).keys().next().done});if(("function"!=typeof E.Map.prototype.clear||0!==(new E.Set).size||0!==(new E.Map).size||"function"!=typeof E.Map.prototype.keys||"function"!=typeof E.Set.prototype.keys||"function"!=typeof E.Map.prototype.forEach||"function"!=typeof E.Set.prototype.forEach||c(E.Map)||c(E.Set)||"function"!=typeof(new E.Map).keys().next||hr||!ir)&&m(E,{Map:qn.Map,Set:qn.Set},!0),E.Set.prototype.keys!==E.Set.prototype.values&&b(E.Set.prototype,"keys",E.Set.prototype.values,!0),xe(Object.getPrototypeOf((new E.Map).keys())),xe(Object.getPrototypeOf((new E.Set).keys())),h&&"has"!==E.Set.prototype.has.name){var dr=E.Set.prototype.has;Z(E.Set.prototype,"has",function(e){return n(dr,this,e)})}}m(E,qn),ke(E.Map),ke(E.Set)}var gr=function(e){if(!ne.TypeIsObject(e))throw new TypeError("target must be an object")},yr={apply:function(){return ne.Call(ne.Call,null,arguments)},construct:function(e,t){if(!ne.IsConstructor(e))throw new TypeError("First argument must be a constructor.");var n=arguments.length>2?arguments[2]:e;if(!ne.IsConstructor(n))throw new TypeError("new.target must be a constructor.");return ne.Construct(e,t,n,"internal")},deleteProperty:function(e,t){if(gr(e),f){var n=Object.getOwnPropertyDescriptor(e,t);if(n&&!n.configurable)return!1}return delete e[t]},has:function(e,t){return gr(e),t in e}};Object.getOwnPropertyNames&&Object.assign(yr,{ownKeys:function(e){gr(e);var t=Object.getOwnPropertyNames(e);return ne.IsCallable(Object.getOwnPropertySymbols)&&A(t,Object.getOwnPropertySymbols(e)),t}});var vr=function(e){return!u(e)};if(Object.preventExtensions&&Object.assign(yr,{isExtensible:function(e){return gr(e),Object.isExtensible(e)},preventExtensions:function(e){return gr(e),vr(function(){Object.preventExtensions(e)})}}),f){var br=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(!r){var o=Object.getPrototypeOf(e);if(null===o)return;return br(o,t,n)}return"value"in r?r.value:r.get?ne.Call(r.get,n):void 0},mr=function(e,t,r,o){var i=Object.getOwnPropertyDescriptor(e,t);if(!i){var s=Object.getPrototypeOf(e);if(null!==s)return mr(s,t,r,o);i={value:void 0,writable:!0,enumerable:!0,configurable:!0}}if("value"in i){if(!i.writable)return!1;if(!ne.TypeIsObject(o))return!1;var a=Object.getOwnPropertyDescriptor(o,t);return a?ee.defineProperty(o,t,{value:r}):ee.defineProperty(o,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}return i.set?(n(i.set,o,r),!0):!1};Object.assign(yr,{defineProperty:function(e,t,n){return gr(e),vr(function(){Object.defineProperty(e,t,n)})},getOwnPropertyDescriptor:function(e,t){return gr(e),Object.getOwnPropertyDescriptor(e,t)},get:function(e,t){gr(e);var n=arguments.length>2?arguments[2]:e;return br(e,t,n)},set:function(e,t,n){gr(e);var r=arguments.length>3?arguments[3]:e;return mr(e,t,n,r)}})}if(Object.getPrototypeOf){var kr=Object.getPrototypeOf;yr.getPrototypeOf=function(e){return gr(e),kr(e)}}if(Object.setPrototypeOf&&yr.getPrototypeOf){var xr=function(e,t){for(var n=t;n;){if(e===n)return!0;n=yr.getPrototypeOf(n)}return!1};Object.assign(yr,{setPrototypeOf:function(e,t){if(gr(e),null!==t&&!ne.TypeIsObject(t))throw new TypeError("proto must be an object or null");return t===ee.getPrototypeOf(e)?!0:ee.isExtensible&&!ee.isExtensible(e)?!1:xr(e,t)?!1:(Object.setPrototypeOf(e,t),!0)}})}var wr=function(e,t){if(ne.IsCallable(E.Reflect[e])){var n=l(function(){return E.Reflect[e](1),E.Reflect[e](NaN),E.Reflect[e](!0),!0});n&&Z(E.Reflect,e,t)}else b(E.Reflect,e,t)};Object.keys(yr).forEach(function(e){wr(e,yr[e])});var Or=E.Reflect.getPrototypeOf;if(h&&Or&&"getPrototypeOf"!==Or.name&&Z(E.Reflect,"getPrototypeOf",function(e){return n(Or,E.Reflect,e)}),E.Reflect.setPrototypeOf&&l(function(){return E.Reflect.setPrototypeOf(1,{}),!0})&&Z(E.Reflect,"setPrototypeOf",yr.setPrototypeOf),E.Reflect.defineProperty&&(l(function(){var e=!E.Reflect.defineProperty(1,"test",{value:1}),t="function"!=typeof Object.preventExtensions||!E.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})||Z(E.Reflect,"defineProperty",yr.defineProperty)),E.Reflect.construct&&(l(function(){var e=function(){};return E.Reflect.construct(function(){},[],e)instanceof e})||Z(E.Reflect,"construct",yr.construct)),"Invalid Date"!==String(new Date(NaN))){var Sr=Date.prototype.toString,Tr=function(){var e=+this;return e!==e?"Invalid Date":ne.Call(Sr,this)};Z(Date.prototype,"toString",Tr)}var Er={anchor:function(e){return ne.CreateHTML(this,"a","name",e)},big:function(){return ne.CreateHTML(this,"big","","")},blink:function(){return ne.CreateHTML(this,"blink","","")},bold:function(){return ne.CreateHTML(this,"b","","")},fixed:function(){return ne.CreateHTML(this,"tt","","")},fontcolor:function(e){return ne.CreateHTML(this,"font","color",e)},fontsize:function(e){return ne.CreateHTML(this,"font","size",e)},italics:function(){return ne.CreateHTML(this,"i","","")},link:function(e){return ne.CreateHTML(this,"a","href",e)},small:function(){return ne.CreateHTML(this,"small","","")},strike:function(){return ne.CreateHTML(this,"strike","","")},sub:function(){return ne.CreateHTML(this,"sub","","")},sup:function(){return ne.CreateHTML(this,"sup","","")}};d(Object.keys(Er),function(e){var t=String.prototype[e],r=!1;if(ne.IsCallable(t)){var o=n(t,"",' " '),i=_([],o.match(/"/g)).length;r=o!==o.toLowerCase()||i>2}else r=!0;r&&Z(String.prototype,e,Er[e])});var Nr=function(){if(!K)return!1;var e="object"==typeof JSON&&"function"==typeof JSON.stringify?JSON.stringify:null;if(!e)return!1;if("undefined"!=typeof e(U()))return!0;if("[null]"!==e([U()]))return!0;var t={a:U()};return t[U()]=!0,"{}"!==e(t)}(),Mr=l(function(){return K?"{}"===JSON.stringify(Object(U()))&&"[{}]"===JSON.stringify([Object(U())]):!0});if(Nr||!Mr){var jr=JSON.stringify;Z(JSON,"stringify",function(e){if("symbol"!=typeof e){var t;arguments.length>1&&(t=arguments[1]);var o=[e];if(r(t))o.push(t);else{var i=ne.IsCallable(t)?t:null,s=function(e,t){var r=i?n(i,this,e,t):t;return"symbol"!=typeof r?$.symbol(r)?wt({})(r):r:void 0};o.push(s)}return arguments.length>2&&o.push(arguments[2]),jr.apply(this,o)}})}return E})}).call(t,function(){return this}(),n(15))},function(e,t){function n(){l=!1,s.length?u=s.concat(u):c=-1,u.length&&r()}function r(){if(!l){var e=setTimeout(n);l=!0;for(var t=u.length;t;){for(s=u,u=[];++c<t;)s&&s[c].run();c=-1,t=u.length}s=null,l=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var s,a=e.exports={},u=[],l=!1,c=-1;a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new o(e,t)),1!==u.length||l||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=i,a.addListener=i,a.once=i,a.off=i,a.removeListener=i,a.removeAllListeners=i,a.emit=i,a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}}])});